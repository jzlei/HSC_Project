(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    290427,       6521]
NotebookOptionsPosition[    284383,       6358]
NotebookOutlinePosition[    284818,       6375]
CellTagsIndexPosition[    284775,       6372]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path0", "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<data/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeDir", "[", "str_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "[", "str", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "str", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"str_", ",", "path0_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "path", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"path", "=", 
       RowBox[{"path0", "<>", "str", "<>", "\"\</\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "[", "path", "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", "path", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "path", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.670637960491844*^9, 3.670637993319002*^9}, {
   3.692681156394484*^9, 3.692681180698061*^9}, {3.692708745233873*^9, 
   3.692708750470989*^9}, 3.705375234865492*^9, {3.706431598487836*^9, 
   3.706431602631184*^9}, 3.7065840289877768`*^9, {3.717285072396082*^9, 
   3.717285072803644*^9}, {3.722861426702907*^9, 3.722861470642603*^9}, {
   3.723601131397069*^9, 3.72360113669184*^9}, 3.723619590517804*^9, {
   3.723760401757689*^9, 3.7237604880032578`*^9}, 3.7237609122219877`*^9, {
   3.723762008276545*^9, 3.723762015636158*^9}, {3.735898476317437*^9, 
   3.7358984763328743`*^9}, {3.7424270315972424`*^9, 
   3.7424270383620443`*^9}, {3.7507187357179337`*^9, 
   3.7507187361168547`*^9}},ExpressionUUID->"a98d8271-bc84-4652-b007-\
57f3b9cbaade"],

Cell[CellGroupData[{

Cell["Functions & parameters", "Title",
 CellChangeTimes->{{3.6706380013985243`*^9, 3.670638006582724*^9}, 
   3.684213182091154*^9, 
   3.687843436534086*^9},ExpressionUUID->"e9e70b1b-eeb4-4b12-ba42-\
c077f850a370"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Functions", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Eq1", "[", 
        RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_", ",", "st_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "s", "]"}], "+", 
            RowBox[{"\[Kappa]N", "[", "n", "]"}], "+", 
            RowBox[{"\[Kappa]P", "[", "p", "]"}], "+", "\[Kappa]R"}], ")"}]}],
          "s"}], "+", 
        RowBox[{"2", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[Gamma]S"}], " ", "\[Tau]S"}], "]"}], " ", 
         RowBox[{"\[Beta]", "[", "st", "]"}], "st"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq2", "[", 
        RowBox[{"s_", ",", "n_", ",", "st_", ",", "nt_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Gamma]N"}], " ", "n"}], "+", 
        RowBox[{
         RowBox[{"AN", "[", "nt", "]"}], 
         RowBox[{"\[Kappa]N", "[", "nt", "]"}], 
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]], "st"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq3", "[", 
        RowBox[{"s_", ",", "r_", ",", "st_", ",", "rt_"}], "]"}], ":=", "0"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq4", "[", 
        RowBox[{
        "s_", ",", "p_", ",", "st_", ",", "pt_", ",", "sts_", ",", "pts_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Gamma]P"}], " ", "p"}], "+", 
        RowBox[{
         RowBox[{"AP", "[", "pt", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Kappa]P", "[", "pt", "]"}], 
            SuperscriptBox["10", 
             RowBox[{"-", "4"}]], "st"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Gamma]P"}], " ", "\[Tau]PS"}], "]"}], 
            RowBox[{"\[Kappa]P", "[", "pts", "]"}], 
            SuperscriptBox["10", 
             RowBox[{"-", "4"}]], "sts"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Kappa]N", "[", "n_", "]"}], ":=", 
       RowBox[{"f0", " ", 
        FractionBox[
         SuperscriptBox["\[Theta]1", "s1"], 
         RowBox[{
          SuperscriptBox["\[Theta]1", "s1"], "+", 
          SuperscriptBox["n", "s1"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Kappa]P", "[", "p_", "]"}], ":=", 
       FractionBox["\[Kappa]Pbar", 
        RowBox[{"1", "+", 
         RowBox[{"KP", " ", 
          SuperscriptBox["p", "s4"]}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Beta]", "[", "s_", "]"}], ":=", 
       RowBox[{"k0", " ", 
        FractionBox[
         SuperscriptBox["\[Theta]2", "s2"], 
         RowBox[{
          SuperscriptBox["\[Theta]2", "s2"], "+", 
          SuperscriptBox["s", "s2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AN", "[", "n_", "]"}], ":=", 
       RowBox[{"ANmax", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Eta]N", "[", "n", "]"}]}], "\[Tau]NM"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Eta]N", "[", "n_", "]"}], ":=", 
       RowBox[{"\[Eta]Nbar", " ", 
        FractionBox[
         SuperscriptBox["n", "\[Nu]1"], 
         RowBox[{
          SuperscriptBox["\[Theta]var1", "\[Nu]1"], "+", 
          SuperscriptBox["n", "\[Nu]1"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AP", "[", "p_", "]"}], ":=", 
       RowBox[{"APmax", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Eta]P", "[", "p", "]"}]}], "\[Tau]PM"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Eta]P", "[", "p_", "]"}], ":=", 
       RowBox[{"\[Eta]Pbar", " ", 
        FractionBox[
         SuperscriptBox["p", "\[Nu]4"], 
         RowBox[{
          SuperscriptBox["\[Theta]var4", "\[Nu]4"], "+", 
          SuperscriptBox["p", "\[Nu]4"]}]]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDefaultValue", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s0", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]S", "=", "0.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]S", "=", "2.8"}], ";", "\[IndentingNewLine]", 
      RowBox[{"k0", "=", "3.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s2", "=", "4"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]R", ":=", "0.00469"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", "6.9"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]N", "=", "2.4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]NM", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ANmax", "=", "70635"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]Nbar", "=", "0.27"}], ";", "\[IndentingNewLine]", 
      RowBox[{"f0", "=", "0.40"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]1", "=", "0.36"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s1", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]var1", "=", "79.7"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]1", "=", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"p0", "=", "3.1071"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]P", "=", "0.05"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PM", "=", "7"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PS", "=", "9.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]Pbar", "=", "0.424"}], ";", "\[IndentingNewLine]", 
      RowBox[{"APmax", "=", "487837"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Pbar", "=", "0.372"}], ";", "\[IndentingNewLine]", 
      RowBox[{"KP", "=", "11.66"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s4", "=", "1.29"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]Psum", ":=", 
       RowBox[{"\[Tau]PM", "+", "\[Tau]PS"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]var4", "=", "35.9"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]4", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"para0", "=", 
       RowBox[{"{", 
        RowBox[{
        "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", "\[Tau]PS", ",", "\[Tau]PM", 
         ",", "\[Gamma]P", ",", "\[Theta]var4", ",", "APmax"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParaSample", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.372", ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.0744", ",", "13"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "14"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9.5442", ",", "11.583"}], "}"}]}], "}"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDE", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r00", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
              RowBox[{"n", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq3", "[", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "n00"}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "p00"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               "0"}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.1"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "300"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solODE", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r00", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", "t", " ", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq3", "[", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", "0", "]"}], "\[Equal]", "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", "0", "]"}], "\[Equal]", "n00"}], ",", 
           RowBox[{
            RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r00"}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p00"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tf"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solSS", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Eq1s", ",", "Eq2s", ",", "Eq3s", ",", "Eq4s", ",", "sol", ",", "s", 
       ",", "n", ",", "p", ",", "s00", ",", "n00", ",", "p00"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Eq1s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq1", "[", 
        RowBox[{"s", ",", "n", ",", "r", ",", "p", ",", "s"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq2s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq2", "[", 
        RowBox[{"s", ",", "n", ",", "s", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq3s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq3", "[", 
        RowBox[{"s", ",", "r", ",", "s", ",", "r"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq4s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq4", "[", 
        RowBox[{"s", ",", "p", ",", "s", ",", "p", ",", "s", ",", "p"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"solODE", "[", 
        RowBox[{"s0", ",", "n0", ",", "p0", ",", "300"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s00", ",", "n00", ",", "p00"}], "}"}], "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "/.", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "200", ",", "300"}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Eq1s", "[", 
             RowBox[{"s", ",", "n", ",", "p"}], "]"}], "\[Equal]", "0"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq2s", "[", 
             RowBox[{"s", ",", "n", ",", "p"}], "]"}], "\[Equal]", "0"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq4s", "[", 
             RowBox[{"s", ",", "n", ",", "p"}], "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "n00"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "s00"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "p00"}], "}"}]}], "}"}], ",", 
         RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.670638283365328*^9, 3.670638689813311*^9}, {
   3.670638750326399*^9, 3.6706388894346857`*^9}, {3.6706447603125887`*^9, 
   3.670644764372341*^9}, {3.670644982554762*^9, 3.67064498319564*^9}, {
   3.670647132720804*^9, 3.6706471719801197`*^9}, {3.670647262940811*^9, 
   3.6706473023550377`*^9}, {3.670647438822042*^9, 3.670647588088181*^9}, {
   3.6706476270455008`*^9, 3.670647660547248*^9}, {3.670647923203807*^9, 
   3.670647956944865*^9}, {3.670648318972142*^9, 3.6706483720633097`*^9}, {
   3.670648590978113*^9, 3.6706487701092777`*^9}, {3.670648893256016*^9, 
   3.670648914727648*^9}, {3.6706490227336407`*^9, 3.670649035094318*^9}, {
   3.6707572635336933`*^9, 3.670757298733233*^9}, {3.670757989085494*^9, 
   3.670757989872014*^9}, {3.670758028202396*^9, 3.6707580432427177`*^9}, {
   3.670758248505952*^9, 3.670758278611351*^9}, {3.67075885669274*^9, 
   3.6707588661958647`*^9}, {3.6707590367967587`*^9, 3.67075905573554*^9}, {
   3.6707591410828123`*^9, 3.6707591729245987`*^9}, {3.670759237794437*^9, 
   3.670759266831558*^9}, {3.670759403064406*^9, 3.670759449553146*^9}, {
   3.6707595638968477`*^9, 3.670759609025444*^9}, {3.670759663882133*^9, 
   3.670759669431244*^9}, {3.670933202970696*^9, 3.67093320551064*^9}, {
   3.67093330458993*^9, 3.6709333048204517`*^9}, {3.677984792970112*^9, 
   3.67798479584424*^9}, {3.677985220173709*^9, 3.677985227831847*^9}, {
   3.677985264613844*^9, 3.677985272124468*^9}, {3.677986328429573*^9, 
   3.67798636119067*^9}, {3.6779864748813562`*^9, 3.677986486692421*^9}, {
   3.6779895917437067`*^9, 3.677989595694559*^9}, {3.6780491222027082`*^9, 
   3.678049122972609*^9}, {3.678049180618413*^9, 3.678049187668755*^9}, {
   3.678049241777927*^9, 3.678049244967269*^9}, {3.678049288652048*^9, 
   3.678049294127655*^9}, 3.678049387582143*^9, 3.678049425309566*^9, 
   3.67903429241479*^9, 3.679051773948053*^9, {3.679607360588162*^9, 
   3.679607360847563*^9}, {3.679723831374033*^9, 3.6797240304079227`*^9}, {
   3.6805208983308573`*^9, 3.680520905934223*^9}, {3.680603451967046*^9, 
   3.68060347651293*^9}, {3.680603612719777*^9, 3.680603612996209*^9}, {
   3.6806036891401176`*^9, 3.680603825015971*^9}, {3.681291075934992*^9, 
   3.681291096310175*^9}, {3.6816493858137903`*^9, 3.681649397113949*^9}, {
   3.681679532484428*^9, 3.681679555705513*^9}, {3.6816811004680357`*^9, 
   3.68168110474959*^9}, 3.681681373922724*^9, {3.6816842975330343`*^9, 
   3.6816842983341627`*^9}, {3.682079361526012*^9, 3.682079362888035*^9}, {
   3.682079433008103*^9, 3.682079441627651*^9}, {3.682133141455493*^9, 
   3.682133144685513*^9}, {3.693175731966166*^9, 3.693175832399209*^9}, {
   3.693175893913125*^9, 3.693175917376893*^9}, {3.693176855580016*^9, 
   3.693176880801423*^9}, {3.6931774342098494`*^9, 3.693177439284109*^9}, 
   3.6931774792614393`*^9, 3.693177537139719*^9, {3.6931778224283543`*^9, 
   3.693177823009181*^9}, {3.693178464839321*^9, 3.6931784922906*^9}, {
   3.6931788621153173`*^9, 3.693178912773851*^9}, {3.693179363812162*^9, 
   3.693179420562414*^9}, 3.6931809909559393`*^9, {3.693181229390237*^9, 
   3.693181234710636*^9}, {3.705296631564093*^9, 3.705296657971445*^9}, {
   3.705373748313738*^9, 3.705373809305546*^9}, {3.7054131018210382`*^9, 
   3.705413103170397*^9}, 3.705618729546274*^9, {3.70581235514027*^9, 
   3.705812355626575*^9}, 3.706438396238344*^9, {3.707206542312661*^9, 
   3.7072066559722843`*^9}, 3.707207054517523*^9, 3.70720718544458*^9, {
   3.7126173005324802`*^9, 3.712617300919426*^9}, 3.713180162216433*^9, {
   3.713529588837122*^9, 3.713529589960827*^9}, {3.722861493103753*^9, 
   3.7228615239929857`*^9}, {3.7228627778460073`*^9, 3.722862778211596*^9}, {
   3.723171540484006*^9, 3.7231715609767857`*^9}, {3.723171648980294*^9, 
   3.7231716782406673`*^9}, {3.723171733638232*^9, 3.7231717375432787`*^9}, {
   3.723171971825976*^9, 3.723172022632867*^9}, 3.723172053797518*^9, {
   3.7231721390979967`*^9, 3.723172139405113*^9}, {3.723172990345448*^9, 
   3.723172991942731*^9}, {3.723173031879279*^9, 3.72317307576519*^9}, {
   3.723173152787497*^9, 3.7231731991398907`*^9}, {3.723179923288875*^9, 
   3.723179952959962*^9}, {3.7231799869148407`*^9, 3.723180037154832*^9}, 
   3.723180071933475*^9, {3.72318042261823*^9, 3.723180447683182*^9}, {
   3.723180691673654*^9, 3.7231806964166193`*^9}, {3.723180764121974*^9, 
   3.723180825552979*^9}, {3.723180941139213*^9, 3.72318094196316*^9}, {
   3.723181166912849*^9, 3.723181252006653*^9}, 3.7231968834448853`*^9, {
   3.723196974550602*^9, 3.72319697542843*^9}, {3.723197012204899*^9, 
   3.72319703813837*^9}, {3.7231974243109283`*^9, 3.7231974399699497`*^9}, 
   3.72319754894807*^9, {3.723197579332863*^9, 3.723197579785544*^9}, {
   3.7231978819018097`*^9, 3.723197884276185*^9}, {3.7231980245804234`*^9, 
   3.7231980512545033`*^9}, {3.723198169677456*^9, 3.7231981717471237`*^9}, {
   3.7231987012451553`*^9, 3.723198721805724*^9}, {3.7231988122980843`*^9, 
   3.7231988223918943`*^9}, 3.723199067183722*^9, 3.7232072743626957`*^9, 
   3.723207485412518*^9, {3.723207825872775*^9, 3.7232078260141897`*^9}, {
   3.7232078662467203`*^9, 3.7232078677189503`*^9}, {3.7232079209210653`*^9, 
   3.723207963430765*^9}, {3.7232080661584682`*^9, 3.723208076122789*^9}, {
   3.723335013331545*^9, 3.723335049063427*^9}, 3.723344899805705*^9, {
   3.72334586406909*^9, 3.7233458741986217`*^9}, {3.723345949830613*^9, 
   3.723345970299863*^9}, {3.7233465298248577`*^9, 3.723346530218576*^9}, {
   3.723346577850997*^9, 3.7233465791477203`*^9}, {3.723346610467561*^9, 
   3.7233466107662*^9}, {3.723346645555088*^9, 3.723346684108405*^9}, {
   3.7233468019474173`*^9, 3.723346808055148*^9}, {3.72334734106141*^9, 
   3.723347359274164*^9}, {3.7235454993655043`*^9, 3.723545504493916*^9}, 
   3.7235455643820333`*^9, {3.72354566830085*^9, 3.723545733424725*^9}, {
   3.7235465677762623`*^9, 3.723546568041342*^9}, {3.723546991536961*^9, 
   3.723546991696286*^9}, 3.723549771792575*^9, {3.7235985710595293`*^9, 
   3.723598616455453*^9}, {3.723598665159658*^9, 3.7235986709771967`*^9}, {
   3.7235987099670763`*^9, 3.723598710624737*^9}, {3.723598781222856*^9, 
   3.7235987818232927`*^9}, {3.723598821973815*^9, 3.7235989076891317`*^9}, {
   3.723599042106998*^9, 3.7235990780369453`*^9}, {3.723934694968906*^9, 
   3.723934695662632*^9}, 3.723935372289671*^9, {3.724110581348467*^9, 
   3.7241105915222397`*^9}, {3.724110657395349*^9, 3.7241106632261057`*^9}, 
   3.724110713029283*^9, 3.724111151850218*^9, 3.724111367433302*^9, {
   3.7241123126108437`*^9, 3.724112337383933*^9}, {3.724112742743293*^9, 
   3.724112769425089*^9}, {3.724112799445244*^9, 3.724112822333496*^9}, {
   3.724187945966634*^9, 3.724187948203088*^9}, {3.7242137118580923`*^9, 
   3.7242137121798*^9}, {3.724319494042341*^9, 3.724319499918437*^9}, {
   3.724471116607984*^9, 3.724471171486691*^9}, {3.724472796065092*^9, 
   3.724472799017591*^9}, {3.724546113467739*^9, 3.7245461139008083`*^9}, {
   3.7245644186488256`*^9, 3.724564438784423*^9}, {3.724564791831359*^9, 
   3.724564797701055*^9}, {3.7245650321235447`*^9, 3.724565044372694*^9}, {
   3.724565629184104*^9, 3.724565629865718*^9}, {3.7245884742403812`*^9, 
   3.724588478298646*^9}, {3.725317141983555*^9, 3.725317153727026*^9}, {
   3.725591479063019*^9, 3.725591479897153*^9}, {3.72722911949807*^9, 
   3.727229119838746*^9}, {3.7343153423164177`*^9, 3.734315345473895*^9}, {
   3.7343187635917397`*^9, 3.7343187675033073`*^9}, 3.7343189560767927`*^9, {
   3.7348360049197187`*^9, 3.734836033331873*^9}, {3.735898476360878*^9, 
   3.735898477613634*^9}, {3.742164118795937*^9, 3.742164121118819*^9}, 
   3.7503888670832367`*^9, {3.750718747265806*^9, 
   3.750718762204137*^9}},ExpressionUUID->"c34cd3d0-5416-4640-962a-\
8245b60f67c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Samples", "Title",
 CellChangeTimes->{{3.670759729219967*^9, 3.6707597313623123`*^9}, 
   3.67991065205311*^9},ExpressionUUID->"9377e247-2762-49d0-8d12-\
94f8a9fc713c"],

Cell[CellGroupData[{

Cell["Sample paths", "Section",
 CellChangeTimes->{{3.693004311366055*^9, 
  3.6930043256138897`*^9}},ExpressionUUID->"5b8d6ddf-cd42-43fc-aa76-\
f855a14f16c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<00\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"para", "=", "ParaSample"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "\"\<sample-parameters.dat\>\""}], ",", "para"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "para", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]Pbar", "=", 
      RowBox[{"para", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]PM", "=", 
      RowBox[{"para", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tf", "=", "5000"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
        RowBox[{"solSS", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"solDDE", "[", 
       RowBox[{"s0", ",", "n0", ",", "p01", ",", "tf"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tf", ",", "0.5"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "\"\<sample-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "J"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "[", "t", "]"}], ",", 
          RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", "sol"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tf"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7058774745423098`*^9, 3.705877480440914*^9}, {
   3.705877827582013*^9, 3.705877834097001*^9}, 3.705877875815057*^9, {
   3.7058780922315273`*^9, 3.70587810449603*^9}, {3.707211327202572*^9, 
   3.707211327949271*^9}, {3.712616802788135*^9, 3.712616818583974*^9}, {
   3.7126168584012537`*^9, 3.712616890969425*^9}, 3.7126169236348248`*^9, {
   3.713529591826955*^9, 3.713529591955325*^9}, {3.7240682335510263`*^9, 
   3.724068292660314*^9}, {3.724113284410478*^9, 3.7241132939157267`*^9}, {
   3.724113474549356*^9, 3.724113476788103*^9}, {3.724122138440049*^9, 
   3.724122143234943*^9}, {3.724122359979982*^9, 3.724122363307768*^9}, {
   3.7241226103548613`*^9, 3.724122692662681*^9}, {3.724123948137525*^9, 
   3.724123950115201*^9}, {3.724811244940826*^9, 3.724811251107902*^9}, {
   3.724811470151423*^9, 3.7248114734976892`*^9}, 3.724811792354497*^9, {
   3.724811823866177*^9, 3.72481186843668*^9}, {3.724820128516548*^9, 
   3.724820133623631*^9}, 3.724820239241047*^9, {3.7251637563812513`*^9, 
   3.7251637566819468`*^9}, {3.725316138991023*^9, 3.725316139481414*^9}, 
   3.7253171348844767`*^9, {3.734308652969298*^9, 3.734308667002595*^9}, {
   3.734308812216399*^9, 3.734308840106905*^9}, 3.73430887072447*^9, {
   3.735898478656291*^9, 3.735898478763357*^9}, {3.7507187903785133`*^9, 
   3.750718790615706*^9}},ExpressionUUID->"7326e7a1-8e03-44db-8c31-\
059f2cccc48e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameter dependences", "Title",
 CellChangeTimes->{{3.693004554948452*^9, 
  3.693004562073371*^9}},ExpressionUUID->"5fc3b555-05f4-437c-afda-\
fecd919e68f4"],

Cell[CellGroupData[{

Cell["Two parameters", "Section",
 CellChangeTimes->{{3.686304681778779*^9, 
  3.686304689185974*^9}},ExpressionUUID->"3d75906a-5f7d-402c-b829-\
ff7261145129"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<01\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"para1", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "para"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"para", "=", 
       RowBox[{"para0", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], "]"}]], ",", "1", 
          ",", "1", ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1.5"}], ",", "2.5"}], "}"}], "]"}]]}], "}"}], "*",
         "para"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PM", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"c", "=", 
  RowBox[{"{", 
   RowBox[{
   "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", "\[Tau]PS", ",", "\[Tau]PM"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"no0", "=", "30000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", "\[Tau]PS", ",", 
       "\[Tau]PM", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "no0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "no0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"sol", ",", "sol1", ",", "sol2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str1", "=", "\"\<kappaPbar-tauPM\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "no0"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"para1", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"s0", ",", "n0", ",", "p0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], "<", 
        RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
          RowBox[{"solSS", "[", "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"solDDE", "[", 
       RowBox[{"s0", ",", 
        RowBox[{"1.01", "n0"}], ",", "p01", ",", "tf"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tMax", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s", "/.", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", "\"\<Domain\>\"", 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a0", "=", 
      RowBox[{"{", 
       RowBox[{"i", ",", "\[Kappa]Pbar", ",", "\[Tau]PM", ",", 
        RowBox[{
         RowBox[{"p", "[", "tMax", "]"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "tMax", ",", "tf"}], "}"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "All"}], "]"}], "]"}], "=", "a0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tMax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "J"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-final.dat\>\""}], ",", "i"}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "a0"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-all.dat\>\""}], ",", 
   "c"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6863051160089083`*^9, {3.686305169725684*^9, 3.6863052345052156`*^9}, {
   3.6863053652775297`*^9, 3.686305390950356*^9}, {3.686305586033762*^9, 
   3.6863057674253693`*^9}, {3.686305843684915*^9, 3.686305859412609*^9}, {
   3.686306000577448*^9, 3.686306000911064*^9}, {3.686306530390792*^9, 
   3.6863065309076347`*^9}, {3.6863074520240993`*^9, 3.686307452491362*^9}, {
   3.6863097944505672`*^9, 3.686309846661871*^9}, {3.6863103271271276`*^9, 
   3.686310429873412*^9}, 3.686310461011352*^9, 3.6863525340452547`*^9, {
   3.6863525743569393`*^9, 3.6863526133712053`*^9}, {3.686354089671196*^9, 
   3.686354100501625*^9}, {3.686354198277295*^9, 3.686354210478978*^9}, {
   3.6863543755057096`*^9, 3.686354418412053*^9}, {3.6863545074753857`*^9, 
   3.6863546030595093`*^9}, {3.6863548456044903`*^9, 3.686354848092931*^9}, {
   3.686355233509461*^9, 3.686355234354971*^9}, {3.6863564342405357`*^9, 
   3.686356445610278*^9}, {3.686362793658811*^9, 3.686362822753088*^9}, {
   3.686379661240974*^9, 3.686379731052703*^9}, {3.686386972236158*^9, 
   3.686387068692234*^9}, {3.686387099358636*^9, 3.6863871115762043`*^9}, 
   3.686387161639935*^9, {3.6865197854118853`*^9, 3.686519793816077*^9}, {
   3.686520433069565*^9, 3.6865204637117558`*^9}, {3.6865205402377977`*^9, 
   3.686520579585639*^9}, {3.686520648455587*^9, 3.686520681504723*^9}, {
   3.686520782630011*^9, 3.686520906206305*^9}, {3.686527862244026*^9, 
   3.6865278755681477`*^9}, {3.686528252372531*^9, 3.6865282525231524`*^9}, {
   3.6865289886992598`*^9, 3.686529008181809*^9}, {3.686529707639237*^9, 
   3.6865297181419497`*^9}, {3.686538930271082*^9, 3.686538959499497*^9}, {
   3.686539017402184*^9, 3.6865390194989347`*^9}, {3.686539969399263*^9, 
   3.6865399698365793`*^9}, 3.6865403432592497`*^9, 3.686561331009694*^9, 
   3.686632854159981*^9, 3.686695555028636*^9, {3.713529594916049*^9, 
   3.713529595195241*^9}, {3.7237603613798113`*^9, 3.723760392790024*^9}, {
   3.723760582815116*^9, 3.723760607346327*^9}, {3.723760668169292*^9, 
   3.7237608736649637`*^9}, {3.72376211192144*^9, 3.723762112474072*^9}, {
   3.72376236613239*^9, 3.723762394138674*^9}, {3.7239353446840076`*^9, 
   3.72393534506509*^9}, {3.723935442706924*^9, 3.72393544793484*^9}, {
   3.72393561644991*^9, 3.72393564318636*^9}, {3.724123682038917*^9, 
   3.72412370347296*^9}, {3.724123962601519*^9, 3.7241239630954638`*^9}, 
   3.724125166842458*^9, {3.724125436474958*^9, 3.724125547707946*^9}, {
   3.72418782637251*^9, 3.72418782744608*^9}, {3.724188292511997*^9, 
   3.7241882941379967`*^9}, {3.724588703114399*^9, 3.724588710346439*^9}, {
   3.724588747405498*^9, 3.724588752290517*^9}, {3.7245888709864273`*^9, 
   3.724588892989558*^9}, {3.7245890260149384`*^9, 3.724589069534532*^9}, {
   3.724589106571329*^9, 3.7245891200471287`*^9}, {3.735898479301498*^9, 
   3.7358984795984592`*^9}, {3.742451475643351*^9, 3.7424515066279716`*^9}, {
   3.742451842098822*^9, 3.7424518423398323`*^9}, {3.7424528540343657`*^9, 
   3.742452869334044*^9}, {3.7424529137820044`*^9, 3.742452914064427*^9}, {
   3.74245296103071*^9, 3.742452964265555*^9}, {3.742453008009741*^9, 
   3.742453054377988*^9}, {3.7424530859570847`*^9, 3.742453111004109*^9}, {
   3.742453636252853*^9, 3.7424537330236187`*^9}, {3.742453805748642*^9, 
   3.742453806217835*^9}, 3.7424545980821466`*^9, {3.742455927387898*^9, 
   3.742455937501525*^9}, {3.742456037924211*^9, 3.742456059180921*^9}, {
   3.7507188224296007`*^9, 3.750718846628063*^9}, {3.7507188845308228`*^9, 
   3.750718939509259*^9}},ExpressionUUID->"9c64574a-900f-4781-9bc3-\
0908ab03f847"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Seven parameters", "Section",
 CellChangeTimes->{{3.723934537498371*^9, 3.723934548625987*^9}, {
  3.7241879152021503`*^9, 
  3.7241879166844053`*^9}},ExpressionUUID->"1a7b97d6-fcab-4b0e-974d-\
4b513065f427"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<03\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"para2", "[", "b0_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Abs", "[", "b0", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]]}], "}"}], "*", 
        "para0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PS", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PM", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]P", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]var4", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"APmax", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"no0", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"j", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "no0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"sol", ",", "sol1", ",", "sol2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf0", "=", "3500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str1", "=", "\"\<Seven-parameters\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "no0"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"para2", "[", "1.5", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tf", "=", "tf0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
       RowBox[{"solSS", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], "<", "0.5"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sol", "=", 
         RowBox[{"solDDE", "[", 
          RowBox[{"s01", ",", 
           RowBox[{"1.01", "n01"}], ",", "p01", ",", "tf"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sol", "=", 
         RowBox[{"solDDE", "[", 
          RowBox[{"s0", ",", "n0", ",", "p0", ",", "tf"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tf", "=", "tMax"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a0", "=", 
      RowBox[{"{", 
       RowBox[{
       "i", ",", "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", "\[Tau]PS", ",", 
        "\[Tau]PM", ",", "\[Gamma]P", ",", "\[Theta]var4", ",", "tMax", ",", 
        "APmax", ",", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{"p", "[", "tf", "]"}], "]"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "All"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "i", ",", "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", "\[Tau]PS", ",", 
        "\[Tau]PM", ",", "\[Gamma]P", ",", "\[Theta]var4", ",", "APmax", ",", 
        "tMax", ",", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{"p", "[", "tf", "]"}], "]"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tf", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "J"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-final.dat\>\""}], ",", "i"}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "a0"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-all.dat\>\""}], ",", 
    "c"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ3WSacv76vteOfyT0L4Doea94r4Do+ZOu3QDRx1p0
v4LonK+iP0H0jIf+/DeAtLO1oCyI7vj4zRhEd17YawWi13KwOoLoDOYXTiC6
xtXYG0SHCYT4g2hzE94rLPuB5hx1uQaivxw58AtE71sa+AdEh7IHKwWD+Odr
wLTJZ1V1EG3hd8QIRB/ruWIPooNSvVxB9A77Al8QPanYxR9EL1+fHQeim6Sa
wPRPGx/vU4eA5q25FAGiPb8kJIDo6w5PwfQZU81sEM3W5J4LoqeGLXDnP/za
8VFSugeIFvmjqLfy6mvHK+o6YNopwvzA24+vHc3mpR4E0b+4F/G8A9J8SwT4
QTQAeny5LA==
  "],ExpressionUUID->"69af023c-c7e8-4a7a-be14-bb7cf4331e0e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare models", "Title",
 CellChangeTimes->{{3.724204011248727*^9, 
  3.72420401398448*^9}},ExpressionUUID->"b2774486-d7e5-4469-9fbe-\
3a482d17de06"],

Cell[CellGroupData[{

Cell["Solving DDE functions", "Section",
 CellChangeTimes->{{3.724457865836074*^9, 
  3.724457875875086*^9}},ExpressionUUID->"cf8e96ba-4d5a-4aaa-a790-\
f4192fd5d2d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solDDE2", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r00", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "n0"}],
            ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "p00"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               "0"}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.1"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDE1", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "s0"}],
            ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "n0"}],
            ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "p00"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               "0"}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.1"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDE3", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r00", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
              RowBox[{"n", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq3", "[", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "n00"}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "p00"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               "0"}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.1"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDE4", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r00", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"n", "[", "t", "]"}], "-", "n0"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "-", "p0"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "n0"}],
            ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "p0"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               "0"}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.1"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDEAll", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_", ",", "n0_"}], "]"}],
    ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n0", "\[Equal]", "1"}], ",", 
        RowBox[{"sol", "=", 
         RowBox[{"solDDE1", "[", 
          RowBox[{"s00", ",", "n00", ",", "p00", ",", "tf"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n0", "\[Equal]", "2"}], ",", 
        RowBox[{"sol", "=", 
         RowBox[{"solDDE2", "[", 
          RowBox[{"s00", ",", "n00", ",", "p00", ",", "tf"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n0", "\[Equal]", "3"}], ",", 
        RowBox[{"sol", "=", 
         RowBox[{"solDDE3", "[", 
          RowBox[{"s00", ",", "n00", ",", "p00", ",", "tf"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n0", "\[Equal]", "4"}], ",", 
        RowBox[{"sol", "=", 
         RowBox[{"solDDE4", "[", 
          RowBox[{"s00", ",", "n00", ",", "p00", ",", "tf"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.705634121492999*^9, 3.705634123216782*^9}, {
   3.7056341547681837`*^9, 3.7056341588014317`*^9}, 3.705703120118874*^9, {
   3.7072140487251587`*^9, 3.7072140599981203`*^9}, 3.713503499953683*^9, {
   3.713529612650786*^9, 3.71352961289389*^9}, {3.715145297628366*^9, 
   3.7151452981119547`*^9}, {3.724204315851544*^9, 3.7242044723574047`*^9}, {
   3.724211769451572*^9, 3.7242117739052887`*^9}, {3.7242119765442953`*^9, 
   3.7242120443737297`*^9}, {3.724212083768471*^9, 3.724212086941221*^9}, {
   3.724212120799818*^9, 3.72421214784306*^9}, {3.724212299012724*^9, 
   3.724212331653676*^9}, {3.7242123883283873`*^9, 3.7242123921253138`*^9}, {
   3.724212556090514*^9, 3.724212567459465*^9}, {3.72421369820418*^9, 
   3.724213701164584*^9}, {3.724228772832912*^9, 3.7242287751596527`*^9}, {
   3.724581261070347*^9, 3.724581272299798*^9}, {3.724581547886445*^9, 
   3.72458156096017*^9}, {3.724925744316347*^9, 3.724925761783614*^9}, {
   3.72722910654782*^9, 3.727229169106759*^9}, {3.735898482165175*^9, 
   3.735898483038991*^9}, {3.742427529840803*^9, 3.742427550295425*^9}, {
   3.742427884722164*^9, 3.742427888666033*^9}, {3.742427920220693*^9, 
   3.742427925494075*^9}, {3.742434103755847*^9, 3.742434131626944*^9}, {
   3.750719020739422*^9, 
   3.750719035701797*^9}},ExpressionUUID->"d10962af-3379-4912-ae30-\
083d0138d85f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sample paths of multiple models", "Section",
 CellChangeTimes->{{3.72492344966136*^9, 3.7249235239927053`*^9}, {
   3.724927146986493*^9, 3.724927149642447*^9}, {3.725483360660287*^9, 
   3.725483362126417*^9}, 
   3.727222981299984*^9},ExpressionUUID->"966d137b-1af7-4e9b-ac9a-\
2d10bb6b1c50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"para", ",", "para1", ",", "para2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"path", "=", 
  RowBox[{"MakeDirNo", "[", 
   RowBox[{"\"\<05\>\"", ",", "path0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.1", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.1", ",", "9"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str1", "=", "\"\<Compare-models-sample\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters.dat\>\""}], ",", 
    "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "a", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAll", "[", 
      RowBox[{"sol", ",", "sol1", ",", "sol2"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Kappa]Pbar", ",", "\[Tau]PM"}], "}"}], "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tf", "=", "5000"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "4"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
          RowBox[{"solSS", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{"solDDEAll", "[", 
          RowBox[{"s01", ",", "n01", ",", "p0", ",", "tf", ",", "j"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"J", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"0", 
               RowBox[{"r", "[", "t", "]"}]}], ",", 
              RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"-", "800"}], "+", "0.01"}], ",", "tf", ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"path", "<>", "str1", "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<.dat\>\""}], ",", 
          "J"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.724923555565692*^9, 3.724923610823339*^9}, {
   3.724924477523538*^9, 3.7249246299509687`*^9}, {3.724935149306293*^9, 
   3.7249351611180897`*^9}, {3.724937002744411*^9, 3.72493701650158*^9}, {
   3.724937139393725*^9, 3.7249371419915257`*^9}, {3.725485025354021*^9, 
   3.725485030141657*^9}, {3.7254851644200497`*^9, 3.725485186040432*^9}, {
   3.725485403553362*^9, 3.725485423096747*^9}, {3.725485606666008*^9, 
   3.7254857710057297`*^9}, {3.725589782868718*^9, 3.725589783448242*^9}, {
   3.72558983537186*^9, 3.725589857125278*^9}, {3.725591306064412*^9, 
   3.7255913097214003`*^9}, {3.725591362213944*^9, 3.7255913649775267`*^9}, {
   3.725591435995016*^9, 3.725591453506996*^9}, {3.727217948735379*^9, 
   3.7272179574260197`*^9}, {3.7272198531166487`*^9, 3.727219858463622*^9}, {
   3.7272201518939342`*^9, 3.7272201846727448`*^9}, {3.727229186579686*^9, 
   3.727229187457114*^9}, {3.7273188444925537`*^9, 3.72731885178755*^9}, {
   3.7273193414291067`*^9, 3.727319341817725*^9}, {3.727320117407724*^9, 
   3.7273201215686283`*^9}, 3.7273201812612762`*^9, {3.7273202209447203`*^9, 
   3.727320233305067*^9}, {3.72732028660004*^9, 3.727320293760199*^9}, {
   3.735898489355748*^9, 3.735898489510294*^9}, {3.742427953092301*^9, 
   3.742427953443912*^9}, {3.7435691271297007`*^9, 3.743569142624056*^9}, {
   3.750719166635952*^9, 
   3.750719169337244*^9}},ExpressionUUID->"a39837ad-6556-4b85-a1f6-\
de46abfc76f5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bistability", "Title",
 CellChangeTimes->{{3.725022453091249*^9, 
  3.7250224552925453`*^9}},ExpressionUUID->"dc16079c-f52f-44e2-b1ee-\
678fa5df3794"],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.72502282625469*^9, 
  3.725022828440483*^9}},ExpressionUUID->"5d0a77eb-7723-46dd-a798-\
6eba463ccbca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solDDEbi", "[", 
    RowBox[{
    "s00_", ",", "n00_", ",", "p00_", ",", "tf_", ",", "per_", ",", "amp1_", 
     ",", "amp2_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r00", ",", "sol", ",", "a1", ",", "a2", ",", "a3", ",", "Eq1b", ",", 
       "Eq2b", ",", "Eq3b", ",", "Eq4b"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq3b", "[", 
        RowBox[{"s_", ",", "r_", ",", "st_", ",", "rt_"}], "]"}], ":=", "0"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Eq1b", "[", 
           RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_", ",", "st_"}], "]"}],
           ":=", 
          RowBox[{"Eq1", "[", 
           RowBox[{"s", ",", "n", ",", "r", ",", "p", ",", "st"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eq2b", "[", 
           RowBox[{"s_", ",", "n_", ",", "st_", ",", "nt_"}], "]"}], ":=", 
          "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eq4b", "[", 
           RowBox[{
           "s_", ",", "p_", ",", "st_", ",", "pt_", ",", "sts_", ",", 
            "pts_"}], "]"}], ":=", 
          RowBox[{"Eq4", "[", 
           RowBox[{
           "s", ",", "p", ",", "st", ",", "pt", ",", "sts", ",", "pts"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Eq1b", "[", 
           RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_", ",", "st_"}], "]"}],
           ":=", 
          RowBox[{"Eq1", "[", 
           RowBox[{"s", ",", "n", ",", "r", ",", "p", ",", "st"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eq2b", "[", 
           RowBox[{"s_", ",", "n_", ",", "st_", ",", "nt_"}], "]"}], ":=", 
          RowBox[{"Eq2", "[", 
           RowBox[{"s", ",", "n", ",", "st", ",", "nt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eq4b", "[", 
           RowBox[{
           "s_", ",", "p_", ",", "st_", ",", "pt_", ",", "sts_", ",", 
            "pts_"}], "]"}], ":=", 
          RowBox[{"Eq4", "[", 
           RowBox[{
           "s", ",", "p", ",", "st", ",", "pt", ",", "sts", ",", "pts"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Eq1b", "[", 
           RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_", ",", "st_"}], "]"}],
           ":=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eq2b", "[", 
           RowBox[{"s_", ",", "n_", ",", "st_", ",", "nt_"}], "]"}], ":=", 
          "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eq4b", "[", 
           RowBox[{
           "s_", ",", "p_", ",", "st_", ",", "pt_", ",", "sts_", ",", 
            "pts_"}], "]"}], ":=", 
          RowBox[{"Eq4", "[", 
           RowBox[{
           "s", ",", "p", ",", "st", ",", "pt", ",", "sts", ",", "pts"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1b", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2b", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
              RowBox[{"n", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4b", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], " ", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "n00"}], " ", ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            RowBox[{"p00", " ", "amp1", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"amp2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"2", "\[Pi]", " ", 
                   RowBox[{"t", "/", "per"}]}], "+", 
                  RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               RowBox[{"-", "0.0001"}]}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.00001"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725023138326716*^9, 3.725023172100281*^9}, {
   3.725023542706767*^9, 3.725023545314953*^9}, 3.7253579774858093`*^9, {
   3.725615649703937*^9, 3.725615650064671*^9}, 3.727221085028068*^9, {
   3.735898489530046*^9, 3.735898490244834*^9}, {3.7449786607114363`*^9, 
   3.74497866614262*^9}, {3.744978867324342*^9, 3.7449788743476877`*^9}, {
   3.7449789228457127`*^9, 3.74497892552363*^9}, {3.7449790503950987`*^9, 
   3.7449790509383307`*^9}, 
   3.750720560592061*^9},ExpressionUUID->"19f7de99-de5a-41e4-ad4f-\
fe65cb37f50d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Samples of Bistability", "Section",
 CellChangeTimes->{{3.727222960317295*^9, 
  3.727222972085548*^9}},ExpressionUUID->"72111c56-4985-4161-9f22-\
f6372654bb46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"para", ",", "para1", ",", "para2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"path", "=", 
  RowBox[{"MakeDirNo", "[", 
   RowBox[{"\"\<05\>\"", ",", "path0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", ":=", 
   RowBox[{"{", 
    RowBox[{
    "\[Kappa]Pbar", ",", "\[Tau]PM", ",", "\[Gamma]P", ",", "\[Eta]Pbar", ",",
      "per0", ",", "amp01", ",", "amp11", ",", "amp02", ",", "amp12", ",", 
     "tf"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"str1", "=", "\"\<Bistability-sample\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"sol", ",", "sol1", ",", "sol2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]P", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]Pbar", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]Pbar", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]PM", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"per0", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp01", ":=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp11", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp02", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp12", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "6000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", "3"}], ",", 
    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", "2"}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"sol", ",", "sol1", ",", "sol2", ",", "amp0", ",", "amp1"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s0", ",", "n0", ",", "p0"}], "}"}], "/.", 
          RowBox[{"solSS", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"amp0", "=", "amp01"}], ";", 
           RowBox[{"amp1", "=", "amp11"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"amp0", "=", "amp02"}], ";", 
           RowBox[{"amp1", "=", "amp12"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{"solDDEbi", "[", 
          RowBox[{
          "s01", ",", "n01", ",", "p01", ",", "tf", ",", "per0", ",", "amp0", 
           ",", "amp1", ",", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"J", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"0", 
               RowBox[{"r", "[", "t", "]"}]}], ",", 
              RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"-", "600"}], "+", "0.1"}], ",", "tMax", ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"path", "<>", "str1", "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<.dat\>\""}], ",", 
          "J"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters.dat\>\""}], ",", 
   "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.727223003262854*^9, 3.727223035263176*^9}, {
   3.727223443262372*^9, 3.727223518264414*^9}, {3.7272237109588547`*^9, 
   3.7272237854922123`*^9}, {3.7272238227200823`*^9, 3.727223867700597*^9}, 
   3.727224162446639*^9, {3.727226257100306*^9, 3.727226262447146*^9}, {
   3.727227669063027*^9, 3.727227727920259*^9}, {3.727227786328676*^9, 
   3.727227934531292*^9}, 3.727228044515436*^9, {3.72722847098915*^9, 
   3.727228487812674*^9}, {3.7272288709564734`*^9, 3.727228873003458*^9}, {
   3.727240313822369*^9, 3.727240367642435*^9}, {3.727240638125763*^9, 
   3.727240640665161*^9}, {3.727240980930036*^9, 3.727241008931674*^9}, 
   3.727241515655458*^9, {3.727241623487578*^9, 3.7272416357601957`*^9}, {
   3.727242040977442*^9, 3.727242042749432*^9}, {3.7273227675243063`*^9, 
   3.7273227743870373`*^9}, {3.7273228430457497`*^9, 3.727322843433728*^9}, {
   3.7273228898388567`*^9, 3.727322895887665*^9}, {3.727323272635446*^9, 
   3.72732327658501*^9}, {3.727323328120183*^9, 3.7273233349630938`*^9}, {
   3.7273233839045687`*^9, 3.7273233907362013`*^9}, {3.727323695755056*^9, 
   3.727323699339738*^9}, {3.730367997952153*^9, 3.730368037143764*^9}, {
   3.7303680760456448`*^9, 3.7303681773006907`*^9}, {3.730368854730361*^9, 
   3.730368882509371*^9}, {3.7303696956328487`*^9, 3.7303697006688023`*^9}, {
   3.730370033873701*^9, 3.730370044765068*^9}, {3.73037038194665*^9, 
   3.730370387098033*^9}, {3.7303751224758263`*^9, 3.730375126934025*^9}, {
   3.73589849139436*^9, 3.735898491619618*^9}, {3.7435717015427113`*^9, 
   3.743571746696865*^9}, {3.750719190541789*^9, 
   3.75071919469843*^9}},ExpressionUUID->"25336165-3689-4d19-a765-\
a61d78e6232c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bistability region", "Section",
 CellChangeTimes->{{3.724938127221187*^9, 
  3.724938131060225*^9}},ExpressionUUID->"81acb3ba-ad0e-43ad-b751-\
a275437bdd3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"path", "=", 
  RowBox[{"MakeDirNo", "[", 
   RowBox[{"\"\<12\>\"", ",", "path0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"para2", "[", "b0_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "para"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Pbar", "=", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], 
        RowBox[{"para0", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PM", "=", 
       RowBox[{
        RowBox[{"para0", "[", 
         RowBox[{"[", "4", "]"}], "]"}], 
        SuperscriptBox["10", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]P", "=", 
       RowBox[{"0.15", " ", 
        SuperscriptBox["10", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "/", "10"}], ",", 
            RowBox[{"b", "/", "10"}]}], "}"}], "]"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]Pbar", "=", 
       RowBox[{"0.1", " ", 
        SuperscriptBox["10", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], "/", "10"}], ",", 
            RowBox[{"b", "/", "10"}]}], "}"}], "]"}]]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDefaultValue", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"per0", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp01", ":=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp11", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp02", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"amp12", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"no0", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "no0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"sol", ",", "sol1", ",", "sol2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str1", "=", "\"\<Bistability-region\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "1501"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n01", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", 
    RowBox[{"path", "<>", "str1", "<>", "\"\<-final.dat\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"n01", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"path", "<>", "str1", "<>", "\"\<-final.dat\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "n01", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "n01"}], ",", 
    RowBox[{"i", "\[LessEqual]", "no0"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]Pbar", "=", "1.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]PM", "=", "9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]Pbar", "*=", 
      SuperscriptBox["10", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}], "]"}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Tau]PM", "*=", 
      SuperscriptBox["10", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1.5"}], "}"}], "]"}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]P", "=", 
      RowBox[{"0.15", " ", 
       SuperscriptBox["10", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "10"}], ",", 
           RowBox[{"1", "/", "10"}]}], "}"}], "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]Pbar", "=", 
      RowBox[{"0.1", " ", 
       SuperscriptBox["10", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "10"}], ",", 
           RowBox[{"1", "/", "10"}]}], "}"}], "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "All"}], "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "i", ",", "\[Kappa]Pbar", ",", "\[Tau]PM", ",", "\[Gamma]P", ",", 
        "\[Eta]Pbar", ",", "tf"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
       RowBox[{"solSS", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "3"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{
         "sol", ",", "sol1", ",", "sol2", ",", "per0", ",", "amp0", ",", 
          "amp1"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"per0", "=", 
         SuperscriptBox["10", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"1.2", ",", "2.8"}], "}"}], "]"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amp0", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "5"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amp1", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amp0", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"amp1", "=", "0.9"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amp0", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"amp1", "=", "0"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"dim", "=", "2"}], ",", 
          RowBox[{"dim", "\[LessEqual]", "3"}], ",", 
          RowBox[{"dim", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ClearAll", "[", 
            RowBox[{"sol", ",", "sol1", ",", "sol2"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
           RowBox[{"sol", "=", 
            RowBox[{"solDDEbi", "[", 
             RowBox[{
              RowBox[{"1.0001", "s01"}], ",", "n0", ",", 
              RowBox[{"1.000000001", "p01"}], ",", "tf", ",", "per0", ",", 
              "amp0", ",", "amp1", ",", "dim"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"J", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t", ",", 
                 RowBox[{"s", "[", "t", "]"}], ",", 
                 RowBox[{"n", "[", "t", "]"}], ",", 
                 RowBox[{"r", "[", "t", "]"}], ",", 
                 RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
               RowBox[{"sol", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"-", "100.0001"}], ",", "tMax", ",", "1"}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"a0", "=", 
            RowBox[{"{", 
             RowBox[{
             "i", ",", "dim", ",", "j", ",", "\[Kappa]Pbar", ",", "\[Tau]PM", 
              ",", "per0", ",", "amp0", ",", "amp1", ",", 
              RowBox[{
               RowBox[{"p", "[", "tMax", "]"}], "/.", 
               RowBox[{"sol", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "tMax"}], "}"}]}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"strno", "=", 
            RowBox[{
             RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<-\>\"", "<>", 
             RowBox[{"ToString", "[", "dim", "]"}], "<>", "\"\<-\>\"", "<>", 
             RowBox[{"ToString", "[", "j", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", "strno", "<>", 
              "\"\<.dat\>\""}], ",", "J"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"path", "<>", "str1", "<>", "\"\<-final.dat\>\""}], ",", 
             
             RowBox[{"{", 
              RowBox[{"i", ",", "dim", ",", "j"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "path", "<>", "str1", "<>", "\"\<-parameters-\>\"", "<>", 
              "strno", "<>", "\"\<.dat\>\""}], ",", "a0"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-all.dat\>\""}], ",", 
    "c"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.724938142470727*^9, 3.724938178907041*^9}, {
   3.724938318570125*^9, 3.724938320497479*^9}, {3.724938374946927*^9, 
   3.724938411716567*^9}, {3.7249384546104*^9, 3.7249385412312403`*^9}, {
   3.7249385922614183`*^9, 3.724938816351068*^9}, {3.724938857479734*^9, 
   3.724938972270213*^9}, {3.7249390318818817`*^9, 3.724939065800952*^9}, {
   3.7249390991436577`*^9, 3.7249391535771713`*^9}, {3.724939220910164*^9, 
   3.7249392543360786`*^9}, {3.724939306705119*^9, 3.7249393225488853`*^9}, {
   3.724939368606277*^9, 3.724939414953844*^9}, {3.724939493167263*^9, 
   3.724939503291871*^9}, {3.724939548447534*^9, 3.724939627670432*^9}, {
   3.724940060969277*^9, 3.7249400949934683`*^9}, {3.724940196121909*^9, 
   3.7249404110675163`*^9}, {3.724963289000053*^9, 3.724963289971217*^9}, {
   3.724963321379722*^9, 3.724963322202469*^9}, {3.724964276425582*^9, 
   3.724964289425741*^9}, {3.724964321347056*^9, 3.72496432639355*^9}, {
   3.735898491652054*^9, 3.735898492917794*^9}, {3.74357362973652*^9, 
   3.743573725877551*^9}, {3.743573900461088*^9, 3.743574173657823*^9}, {
   3.7435742060784883`*^9, 3.7435742067030573`*^9}, {3.743574334305895*^9, 
   3.743574384800631*^9}, {3.7435744211644278`*^9, 3.74357442524209*^9}, {
   3.7435744743324203`*^9, 3.7435745118790083`*^9}, 3.743574584221903*^9, {
   3.743574629975601*^9, 3.743574660764125*^9}, {3.743574735901617*^9, 
   3.743574754337234*^9}, {3.7435753509132338`*^9, 3.743575456752164*^9}, {
   3.743575488862363*^9, 3.7435755243198013`*^9}, {3.743575581250869*^9, 
   3.743575581531666*^9}, {3.743575649424548*^9, 3.743575677007996*^9}, {
   3.7435757092580013`*^9, 3.743575717640236*^9}, {3.7435757573838263`*^9, 
   3.743575786224846*^9}, {3.7435758834377737`*^9, 3.743575905906028*^9}, {
   3.7435759612366953`*^9, 3.7435759894435883`*^9}, {3.743576077384207*^9, 
   3.743576081091473*^9}, 3.7435761559955683`*^9, {3.743576313261924*^9, 
   3.743576381507843*^9}, {3.743576536429697*^9, 3.7435765436045094`*^9}, {
   3.743576657358474*^9, 3.743576741621333*^9}, 3.7435768418862963`*^9, {
   3.743576902550585*^9, 3.74357691007198*^9}, {3.7435770698589973`*^9, 
   3.7435771094232893`*^9}, {3.743577277630815*^9, 3.743577279223226*^9}, {
   3.743633774827286*^9, 3.74363384416455*^9}, {3.7436339906866083`*^9, 
   3.743633991505978*^9}, {3.7436552157752953`*^9, 3.7436552616739397`*^9}, {
   3.74365546597351*^9, 3.7436555057746*^9}, {3.743655545988648*^9, 
   3.743655635694181*^9}, {3.743655746730279*^9, 3.743655781887087*^9}, {
   3.7436600199394617`*^9, 3.743660022990617*^9}, 3.743673117957708*^9, {
   3.743673202398712*^9, 3.743673214006445*^9}, {3.743685182828882*^9, 
   3.743685214605523*^9}, 3.743685291968429*^9, {3.750719207651937*^9, 
   3.750719244297613*^9}, {3.750719616258851*^9, 
   3.750719616543664*^9}},ExpressionUUID->"fa09d87f-779a-40f1-a148-\
cc543f40f818"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Only stem cells", "Title",
 CellChangeTimes->{{3.725359901305767*^9, 
  3.725359929366893*^9}},ExpressionUUID->"d0367a3d-db38-49c6-b08f-\
9c2b9b7c7aeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDE3", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "p00_", ",", "tf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "n", ",", "p", ",", "r", ",", "r00", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "n00"}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "p00"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               RowBox[{"-", "0.001"}]}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.01"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tf0", "=", "100000"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"J", ",", "a0", ",", "sol"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Kappa]Pbar", "=", "1.307"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]PM", "=", "15000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "tf0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tMax", "=", "tf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"solDDE3", "[", 
    RowBox[{"s0", ",", "n0", ",", "p0", ",", "tf"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "tMax"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"s", "[", "t", "]"}]}], "}"}], "/.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tf", ",", "0.5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "[", "t", "]"}], "}"}], "/.", "sol"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     RowBox[{"tMax", "-", "300"}], ",", "tMax"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path0", "<>", "\"\<S-Model.dat\>\""}], ",", "J"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.725360023399104*^9, 3.725360023946187*^9}, {
   3.725360190035385*^9, 3.725360206004203*^9}, {3.7253603459207077`*^9, 
   3.725360732476775*^9}, 3.725365347239012*^9, {3.7274039845696898`*^9, 
   3.727404026208476*^9}, {3.7355936191088133`*^9, 3.735593641393372*^9}, {
   3.735593730142777*^9, 3.735593830875183*^9}, {3.73559388802428*^9, 
   3.735594006861758*^9}, {3.735594290418232*^9, 3.73559433097635*^9}, 
   3.735594479048712*^9, 3.7355945651547337`*^9, {3.735898495598892*^9, 
   3.7358984958707848`*^9}, {3.750719265593072*^9, 
   3.750719284120829*^9}},ExpressionUUID->"3f4f1e5d-43fc-4e10-912a-\
0376437a7f4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting Clinical Data (by genetic algorigthm)", "Title",
 CellChangeTimes->{{3.7341393491041527`*^9, 3.7341393544093657`*^9}, {
  3.734156412632043*^9, 
  3.734156440023919*^9}},ExpressionUUID->"887ec986-1490-4c31-9250-\
99f8c74597ab"],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.734139363252252*^9, 3.73413936521699*^9}, {
  3.73413950142465*^9, 3.734139502812887*^9}, {3.7341777058467216`*^9, 
  3.734177707086821*^9}, {3.734662505747026*^9, 
  3.734662507041901*^9}},ExpressionUUID->"0759ba09-f132-4bb7-8714-\
707ebc25bd0d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"len", ",", "size", ",", "a"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitializationG", "[", 
    RowBox[{"initial_", ",", "parameter_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "i", ",", "j", ",", "k", ",", "pop", ",", 
       "population"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"Fitno", ",", "interation", ",", "popno"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fitno", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Init\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"population", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pop", "=", "initial"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "pop", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"FitnessFunction", "[", 
           RowBox[{
            RowBox[{"pop", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "parameter"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"population", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"population", ",", 
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", 
               RowBox[{"pop", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "}"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Initiation finished\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "population", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CrossOver", "[", "population_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "i", ",", "j", ",", "k", ",", "bi", ",", 
       "ci", ",", "bj", ",", "cj"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", "population"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "b", "]"}], ">", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "=", 
          RowBox[{"RandomSample", "[", 
           RowBox[{"b", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"b", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RandomReal", "[", "]"}], "<", "0.1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"k", "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"len", "+", "1"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bi", "=", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"k", "-", "1"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ci", "=", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"k", ";;"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bj", "=", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"k", "-", "1"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cj", "=", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"k", ";;"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Join", "[", 
              RowBox[{"ci", ",", "bj"}], "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"Join", "[", 
              RowBox[{"bi", ",", "cj"}], "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"-", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "a", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mutation", "[", "population_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "i", ",", "j", ",", "k", ",", "l", ",", 
       "js", ",", "ks"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", "population"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "size"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"-", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RandomReal", "[", "]"}], "<", "0.5"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"b", "=", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"len", "-", "2"}], ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{"1", "/", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"js", "=", 
             RowBox[{"RandomSample", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", 
                 RowBox[{"len", "+", "1"}]}], "]"}], ",", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "b"}], "}"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", "0.5"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "js", "]"}], "]"}], "*=", 
                RowBox[{"10", "^", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"Length", "[", "js", "]"}]}], "]"}]}]}], ";"}], 
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "js", "]"}], "]"}], "*=", 
                RowBox[{"10", "^", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", 
                   RowBox[{"Length", "[", "js", "]"}]}], "]"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "9", "]"}], "]"}], "=", 
          RowBox[{"Max", "[", 
           RowBox[{"5", ",", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "9", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "11", "]"}], "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{"0.99", ",", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "11", "]"}], "]"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"2", ";;"}]}], "]"}], "]"}], "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "a", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectionG", "[", 
    RowBox[{"population_", ",", "size_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "c1", ",", "c2", ",", "c3"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", "population"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"a", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"b", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"b", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c1", "=", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"{", "1", "}"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c2", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c3", "=", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"Length", "[", "b", "]"}]}], "}"}], ",", 
              RowBox[{"size", "-", 
               RowBox[{"2", 
                RowBox[{"Length", "[", "c1", "]"}]}], "-", 
               RowBox[{"Length", "[", "c2", "]"}]}]}], "]"}], "]"}], "]"}]}], 
         ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c1", "=", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"{", "1", "}"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c2", "=", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c3", "=", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{"Length", "[", "b", "]"}]}], "}"}], ",", 
              RowBox[{"size", "-", 
               RowBox[{"2", 
                RowBox[{"Length", "[", "c1", "]"}]}], "-", 
               RowBox[{"Length", "[", "c2", "]"}]}]}], "]"}], "]"}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"c1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "c", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenereicMain", "[", 
    RowBox[{
    "initial_", ",", "error_", ",", "steps_", ",", "size0_", ",", "path_", 
     ",", "parameter_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "i", ",", "j", ",", "k", ",", "fitness", 
       ",", "size", ",", "len"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", "=", "size0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"initial", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"a", "=", 
       RowBox[{"InitializationG", "[", 
        RowBox[{"initial", ",", "parameter"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"SelectionG", "[", 
        RowBox[{"a", ",", "size"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "a", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "steps"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "3"}], "]"}], "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"path", "<>", "\"\<Population-\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], 
              ",", "a"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "5"}], "]"}], "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Generation: \>\"", ",", "i", ",", "\"\< Clock: \>\"", ",", 
              RowBox[{"Date", "[", "]"}], ",", 
              "\"\<, Optimal error up to now: \>\"", ",", " ", 
              RowBox[{"1", "/", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              "\"\<. Parameters: \>\"", ",", 
              RowBox[{"{", " ", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"interation", "=", "i"}], ";", "\[IndentingNewLine]", 
         RowBox[{"b", "=", "a"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RandomReal", "[", "]"}], "<", "0.5"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"Mutation", "[", "b", "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"CrossOver", "[", "b", "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "size"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"popno", "=", "j"}], ";", "\[IndentingNewLine]", 
            RowBox[{"fitness", "=", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fitness", "\[LessEqual]", "0"}], "||", 
               RowBox[{
                RowBox[{"RandomReal", "[", "]"}], "<", "0.1"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fitness", "=", 
                RowBox[{"FitnessFunction", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], ",", "parameter"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", "fitness"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"fitness", ">", 
               RowBox[{"1", "/", "error"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Return", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ObjFunction", "[", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"SelectionG", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"a", ",", 
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{";;", "2"}], "]"}], "]"}]}], "]"}], ",", "size"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"a", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ObjFunction", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}], ",", "parameter"}], "]"}], 
         ",", 
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<MATLink`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Once", "[", 
   RowBox[{"Needs", "[", "\"\<MATLink`\>\"", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.734139687876865*^9, 3.734139761362412*^9}, {
   3.73414364572476*^9, 3.734143717151738*^9}, {3.734143859905752*^9, 
   3.73414390441389*^9}, {3.7341440082661877`*^9, 3.734144015601324*^9}, {
   3.734144132790766*^9, 3.734144147375009*^9}, {3.734144192378632*^9, 
   3.734144219325788*^9}, {3.734144763310614*^9, 3.734144816870269*^9}, {
   3.734144847133676*^9, 3.734144860342593*^9}, {3.7341454709892273`*^9, 
   3.734145623590856*^9}, {3.734145702618347*^9, 3.73414575736623*^9}, {
   3.734146221317477*^9, 3.734146290780685*^9}, {3.734146346168542*^9, 
   3.7341463485882893`*^9}, {3.7341467938704653`*^9, 3.734146822243828*^9}, 
   3.734147505941389*^9, {3.734147535973775*^9, 3.734147629442298*^9}, {
   3.734148013922208*^9, 3.734148081865888*^9}, {3.734148122476678*^9, 
   3.734148164329928*^9}, {3.734153059631901*^9, 3.734153059883582*^9}, {
   3.7341530929491167`*^9, 3.7341530943918962`*^9}, {3.734153241288988*^9, 
   3.734153250510807*^9}, {3.734153301449478*^9, 3.734153307248891*^9}, {
   3.734153381281795*^9, 3.734153395257559*^9}, {3.73415347632482*^9, 
   3.7341535668580627`*^9}, {3.734154209842443*^9, 3.7341542383638372`*^9}, {
   3.7341542878012123`*^9, 3.734154375086591*^9}, {3.734154409466186*^9, 
   3.7341545446880198`*^9}, {3.73415457570829*^9, 3.734154884556901*^9}, {
   3.734154933392579*^9, 3.7341550148757277`*^9}, {3.734155232290049*^9, 
   3.7341552651650057`*^9}, {3.7341553470384197`*^9, 3.734155461865101*^9}, {
   3.734155492901327*^9, 3.73415549664889*^9}, {3.734155534567131*^9, 
   3.734155674681535*^9}, {3.734155762157504*^9, 3.734156104010497*^9}, {
   3.7341561984354343`*^9, 3.734156237962021*^9}, {3.7341562683430567`*^9, 
   3.734156269084235*^9}, {3.7341563435580893`*^9, 3.734156379245685*^9}, {
   3.734157902993433*^9, 3.734157918014711*^9}, {3.734157972577347*^9, 
   3.734158023484077*^9}, {3.734158054065301*^9, 3.7341581152153473`*^9}, 
   3.734158146623287*^9, {3.734158315056876*^9, 3.7341584617103653`*^9}, {
   3.734158538127454*^9, 3.734158580372558*^9}, {3.7341587707428102`*^9, 
   3.73415879723167*^9}, {3.734158847855493*^9, 3.7341588530447283`*^9}, {
   3.734158966684688*^9, 3.734158968818118*^9}, {3.734159025414789*^9, 
   3.734159054722269*^9}, {3.734159100449966*^9, 3.7341591368603287`*^9}, {
   3.7341591686700993`*^9, 3.734159175718042*^9}, {3.734159345624011*^9, 
   3.734159531650992*^9}, {3.7341595699737663`*^9, 3.73415958154844*^9}, {
   3.7341596298801126`*^9, 3.734159710412427*^9}, {3.734159744666868*^9, 
   3.7341599145037823`*^9}, {3.734160077319309*^9, 3.734160144936397*^9}, 
   3.734160215018217*^9, {3.734160269306162*^9, 3.7341602699846983`*^9}, {
   3.734160312087283*^9, 3.734160333680728*^9}, {3.73416039863768*^9, 
   3.734160427805601*^9}, {3.734160464862355*^9, 3.734160476779386*^9}, {
   3.7341605586820793`*^9, 3.734160568360478*^9}, {3.7341606285940113`*^9, 
   3.734160694399847*^9}, {3.7341607775586433`*^9, 3.734160942219698*^9}, {
   3.734160982166109*^9, 3.734160983450636*^9}, {3.734161099265699*^9, 
   3.7341611877879333`*^9}, {3.7341612444574842`*^9, 3.73416128753337*^9}, {
   3.734174988838705*^9, 3.734175007536335*^9}, {3.734175039566484*^9, 
   3.73417504728533*^9}, {3.734175118738265*^9, 3.734175176861239*^9}, {
   3.734175207130804*^9, 3.734175207673168*^9}, {3.734175527091648*^9, 
   3.734175616036324*^9}, {3.734175710559263*^9, 3.7341757153171177`*^9}, 
   3.734175756869957*^9, {3.734175837157449*^9, 3.7341758373985147`*^9}, {
   3.734175901415587*^9, 3.734175904957241*^9}, {3.734175965470695*^9, 
   3.734175965640745*^9}, {3.734176332589693*^9, 3.734176353640881*^9}, {
   3.734176393864397*^9, 3.734176394178528*^9}, {3.734176465971238*^9, 
   3.7341764687594433`*^9}, {3.734176596041006*^9, 3.734176596513762*^9}, {
   3.734176638158993*^9, 3.7341766401903963`*^9}, {3.7341769144564543`*^9, 
   3.7341769147963877`*^9}, {3.7341769603002*^9, 3.734176988108322*^9}, 
   3.7341770419264917`*^9, {3.7341770809182796`*^9, 3.734177143263866*^9}, {
   3.734177180996386*^9, 3.7341772063895693`*^9}, {3.734177507877838*^9, 
   3.734177530907518*^9}, {3.73417774098713*^9, 3.734177741298769*^9}, {
   3.734177808687849*^9, 3.734177834813731*^9}, {3.7341778797137012`*^9, 
   3.7341778799751263`*^9}, {3.734226176251899*^9, 3.734226176523761*^9}, {
   3.734227070082408*^9, 3.734227083079688*^9}, {3.7342272257546883`*^9, 
   3.734227230345971*^9}, {3.734227286445808*^9, 3.7342272903651648`*^9}, {
   3.734227393780026*^9, 3.734227398352071*^9}, {3.734227616763433*^9, 
   3.734227638247677*^9}, {3.734227723517124*^9, 3.734227751019359*^9}, {
   3.734227786160657*^9, 3.734227787500085*^9}, {3.734227834017129*^9, 
   3.7342279327092047`*^9}, {3.734227981949464*^9, 3.734227986030851*^9}, {
   3.734228041913262*^9, 3.734228042648303*^9}, {3.734232733992798*^9, 
   3.7342327398202887`*^9}, {3.7342327854682903`*^9, 3.734232831854673*^9}, {
   3.734233073328885*^9, 3.734233086716455*^9}, {3.734233157000822*^9, 
   3.734233179239225*^9}, {3.734233303121217*^9, 3.734233316987833*^9}, {
   3.7342334006402273`*^9, 3.734233484811249*^9}, {3.734233619804317*^9, 
   3.734233654463464*^9}, {3.7342337594757338`*^9, 3.734233849350327*^9}, {
   3.734233902814762*^9, 3.734233906163786*^9}, {3.734233950047822*^9, 
   3.734233954162518*^9}, {3.734234049423106*^9, 3.7342340500239897`*^9}, {
   3.734234270810225*^9, 3.7342342778811693`*^9}, {3.734234431491127*^9, 
   3.7342344327321978`*^9}, {3.734234608761525*^9, 3.7342346251543303`*^9}, {
   3.734662560436075*^9, 3.734662632482375*^9}, {3.734662674380769*^9, 
   3.734662808729888*^9}, {3.734663053953086*^9, 3.734663080812274*^9}, {
   3.734663567212998*^9, 3.734663626873467*^9}, {3.734744090444029*^9, 
   3.734744096212636*^9}, {3.7347441970376053`*^9, 3.734744198674317*^9}, {
   3.7347443175023537`*^9, 3.734744320289053*^9}, {3.734744414602178*^9, 
   3.7347444266863737`*^9}, {3.734744503150103*^9, 3.734744630770721*^9}, {
   3.73533783148669*^9, 3.7353378460270967`*^9}, {3.735338120687817*^9, 
   3.735338121239785*^9}, {3.735355016615193*^9, 3.735355021116522*^9}, 
   3.735355160081161*^9, {3.735355248232244*^9, 3.735355255020612*^9}, 
   3.735355480947517*^9, {3.735357861180479*^9, 3.73535786273801*^9}, {
   3.735359834352928*^9, 3.735359848717227*^9}, {3.735360822121076*^9, 
   3.735360827241791*^9}, {3.7353620027668257`*^9, 3.735362046643705*^9}, {
   3.735381557872114*^9, 3.7353815607844067`*^9}, {3.7353816774536037`*^9, 
   3.735381692854714*^9}, {3.735381998195668*^9, 3.735382006438653*^9}, {
   3.735383135257702*^9, 3.73538315011308*^9}, {3.735383478775743*^9, 
   3.735383480829508*^9}, {3.735383544484774*^9, 3.735383554557452*^9}, {
   3.735383587097324*^9, 3.735383636181726*^9}, {3.735383669309745*^9, 
   3.735383671986761*^9}, {3.735384050939934*^9, 3.7353840516976624`*^9}, {
   3.735384090517591*^9, 3.7353841228943377`*^9}, {3.735384168154072*^9, 
   3.735384222204091*^9}, {3.7353844124023533`*^9, 3.735384576624383*^9}, {
   3.735384758403425*^9, 3.7353847590495167`*^9}, {3.7353848400082207`*^9, 
   3.735384840298992*^9}, {3.735384887750473*^9, 3.735384911084588*^9}, {
   3.735385162760132*^9, 3.7353852468781652`*^9}, {3.735385318672607*^9, 
   3.735385340199565*^9}, {3.735385379931994*^9, 3.7353853812557907`*^9}, {
   3.73538541419636*^9, 3.735385503955744*^9}, {3.735385551345261*^9, 
   3.735385601617854*^9}, {3.7353856647712507`*^9, 3.735385691699514*^9}, {
   3.7353858015471573`*^9, 3.735385826387621*^9}, {3.735386466897522*^9, 
   3.7353864760346327`*^9}, {3.7353867745966*^9, 3.7353867757043467`*^9}, {
   3.735386805927538*^9, 3.735386869707556*^9}, {3.7353871542313147`*^9, 
   3.7353871758841963`*^9}, 3.735387220191259*^9, {3.735388375275983*^9, 
   3.735388375765085*^9}, {3.735388688922184*^9, 3.735388689472628*^9}, {
   3.735388919010007*^9, 3.73538893688089*^9}, {3.735416540172223*^9, 
   3.7354166119482393`*^9}, {3.735416675960989*^9, 3.7354166843652573`*^9}, {
   3.7354167330379343`*^9, 3.735416763434465*^9}, {3.7354169330051947`*^9, 
   3.735417056861897*^9}, {3.7354209425205183`*^9, 3.7354209450400677`*^9}, {
   3.735420984195372*^9, 3.73542103353365*^9}, 3.735514560406891*^9, {
   3.735514755144288*^9, 3.735514768941597*^9}, {3.735514838442132*^9, 
   3.73551488681719*^9}, {3.735516156146119*^9, 3.735516187996304*^9}, {
   3.735516805599072*^9, 3.735516807047101*^9}, {3.735517685108374*^9, 
   3.7355176952881737`*^9}, {3.7355192677900133`*^9, 3.735519277383168*^9}, {
   3.735521714747923*^9, 3.735521809107703*^9}, {3.735526892596348*^9, 
   3.7355268994330606`*^9}, {3.735527008756159*^9, 3.735527014022696*^9}, {
   3.735528475635235*^9, 3.7355285661298637`*^9}, {3.735529094478291*^9, 
   3.735529100525405*^9}, {3.7355296605591307`*^9, 3.7355296807923813`*^9}, 
   3.735529767140205*^9, 3.735530090247055*^9, {3.735530152587213*^9, 
   3.7355301530348787`*^9}, {3.735532094529171*^9, 3.735532103413467*^9}, {
   3.7356034693943167`*^9, 3.735603470937038*^9}, {3.735608802066481*^9, 
   3.7356088671755657`*^9}, {3.7356089267288427`*^9, 3.735608926979576*^9}, {
   3.735617410358761*^9, 3.7356174125869637`*^9}, {3.7356191525049057`*^9, 
   3.7356192053467007`*^9}, {3.7356198433172197`*^9, 3.735619852638109*^9}, {
   3.735619909910679*^9, 3.735619910484887*^9}, {3.735619948539321*^9, 
   3.7356199489382133`*^9}, {3.735620029225121*^9, 3.735620081028528*^9}, {
   3.73562023310023*^9, 3.7356202335913687`*^9}, {3.7356478754809647`*^9, 
   3.735647939320979*^9}, {3.7356479716995773`*^9, 3.735647976040856*^9}, {
   3.735648755807032*^9, 3.735648761267761*^9}, {3.7356488796887627`*^9, 
   3.735648911229971*^9}, {3.7356494291328793`*^9, 3.735649447508996*^9}, {
   3.73569638268443*^9, 3.7356963842518597`*^9}, {3.7357031722493973`*^9, 
   3.735703172474567*^9}, {3.7357032154524183`*^9, 3.735703224394821*^9}, {
   3.735703648762455*^9, 3.735703739178618*^9}, 3.735703862580737*^9, {
   3.7357047297641907`*^9, 3.735704756668292*^9}, 3.735704870841031*^9, {
   3.73570520730308*^9, 3.735705212938508*^9}, {3.7357055112377462`*^9, 
   3.735705551564138*^9}, 3.7357056855738783`*^9, {3.735708161980228*^9, 
   3.735708175150484*^9}, {3.735820168748149*^9, 3.735820187383411*^9}, {
   3.73582112500817*^9, 3.7358211254936123`*^9}, {3.735857718033436*^9, 
   3.73585772167133*^9}, {3.735858727603854*^9, 3.735858750244178*^9}, {
   3.735860146617593*^9, 3.7358601491917*^9}, 3.735860212110833*^9, {
   3.735860334599285*^9, 3.735860372181005*^9}, {3.735860416383555*^9, 
   3.735860423662058*^9}, {3.735860585296879*^9, 3.7358606141130447`*^9}, {
   3.735860645144884*^9, 3.7358606574296*^9}, {3.735863574241395*^9, 
   3.735863629377515*^9}, {3.735878469471589*^9, 3.735878490687263*^9}, {
   3.735878521148841*^9, 3.735878524200563*^9}, {3.735886626180409*^9, 
   3.7358866393451853`*^9}, {3.73588672759457*^9, 3.735886772479417*^9}, {
   3.7358868073620167`*^9, 3.7358868291029053`*^9}, {3.7358869526021748`*^9, 
   3.735886960558795*^9}, {3.735898495891305*^9, 3.735898496888257*^9}, {
   3.7358989735309067`*^9, 3.735898982588513*^9}, {3.736322444744424*^9, 
   3.736322444956093*^9}, 3.7363225299045362`*^9, {3.736334811337392*^9, 
   3.7363348147286*^9}, {3.750720567618272*^9, 
   3.750720568121189*^9}},ExpressionUUID->"2dce5521-0180-4c4d-856b-\
62eaf680c86b"],

Cell[BoxData[
 TemplateBox[{
  "n$","shdw",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"n$\\\\\\\"\\\"}]\\) appears in \
multiple contexts \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"MATLink`Private`\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}]\\); definitions in context \\!\
\\(\\*RowBox[{\\\"\\\\\\\"MATLink`Private`\\\\\\\"\\\"}]\\) may shadow or be \
shadowed by other definitions.\"",2,19,1,18098324239900085918,"Local",
   "MATLink`Private`n$"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.735387128818453*^9, 3.7353872856058702`*^9, 3.735388695536419*^9, 
   3.7353889732165413`*^9, 3.73538914619855*^9, 3.7354165437044687`*^9, 
   3.735416765543194*^9, 3.735418245962482*^9, 3.735420829757449*^9, 
   3.7354210608999977`*^9, 3.73551443188842*^9, 3.735516134465343*^9, 
   3.735516189291739*^9, {3.7355168076832247`*^9, 3.7355168114088087`*^9}, 
   3.735518060006048*^9, 3.7355192860545273`*^9, 3.73551949801718*^9, {
   3.735525545385488*^9, 3.735525550892942*^9}, 3.735525589409822*^9, 
   3.735526436763009*^9, 3.7355269702989273`*^9, 3.735528567692726*^9, 
   3.735528800166403*^9, {3.735530067587454*^9, 3.735530091426982*^9}, 
   3.735530165190626*^9, 3.7355304952396183`*^9, 3.735531897916402*^9, 
   3.73553210497582*^9, 3.735600241881132*^9, 3.7356047997702703`*^9, 
   3.7356087514871063`*^9, 3.735608889313204*^9, 3.73560893439841*^9, 
   3.7356109233813467`*^9, 3.735617431218039*^9, 3.735619427809812*^9, 
   3.735619861429196*^9, 3.735620085431329*^9, 3.735620266384287*^9, 
   3.735620419670179*^9, 3.7356463368588333`*^9, 3.735647984856477*^9, 
   3.73564876353391*^9, 3.735648912377747*^9, 3.7356494035644817`*^9, 
   3.7356494477659283`*^9, 3.735695836968624*^9, 3.735696397293932*^9, {
   3.735703203926343*^9, 3.735703225278211*^9}, 3.735703749259623*^9, 
   3.735703863495329*^9, 3.7357047738330593`*^9, 3.7357052176264544`*^9, 
   3.735705410218897*^9, 3.7357055528173656`*^9, 3.7357059377141247`*^9, 
   3.735707314110372*^9, 3.735707668352*^9, 3.73570819586102*^9, 
   3.735710433804847*^9, 3.735780964810348*^9, 3.735791929777732*^9, 
   3.735814449366136*^9, 3.735820069004547*^9, 3.735822003137*^9, 
   3.735822099352878*^9, 3.735850980329607*^9, 3.7358548829774446`*^9, 
   3.7358569527595987`*^9, {3.7358588611157312`*^9, 3.735858865144211*^9}, 
   3.7358593286680527`*^9, 3.735859833230217*^9, {3.7358599622692337`*^9, 
   3.735859967498122*^9}, {3.735860151993149*^9, 3.7358601544533377`*^9}, 
   3.7358602149046917`*^9, {3.7358603603268833`*^9, 3.735860374234009*^9}, 
   3.735860666492875*^9, 3.735860961896454*^9, 3.735862153879179*^9, 
   3.735863421673531*^9, 3.735863648092218*^9, 3.7358662659581003`*^9, 
   3.735872805697524*^9, 3.735877580078166*^9, {3.7358785155754757`*^9, 
   3.7358785253629217`*^9}, 3.735886830939144*^9, 3.735886969083115*^9, 
   3.735895234444332*^9, 3.735896424670239*^9, 3.73589898514881*^9, 
   3.735901427046322*^9, 3.735902502645526*^9, 3.7359030511154423`*^9, 
   3.736250800407935*^9, 3.736251729006649*^9, 3.7363116094289923`*^9, 
   3.736322425769186*^9, {3.736322458685721*^9, 3.736322460952805*^9}, 
   3.736322533446767*^9, 3.736334817104549*^9, 3.736378940420052*^9, 
   3.7364052365239763`*^9, 3.736461720911538*^9, 3.736476056070711*^9, 
   3.7364770755355864`*^9, 3.7364779264296837`*^9, 3.736484537595646*^9, 
   3.7365023047216988`*^9, 3.736544097534987*^9, 3.736630552706193*^9, 
   3.736654240004766*^9, 3.7366581511376534`*^9, 3.7366687093859262`*^9, 
   3.736741160085533*^9, 3.7367614886917467`*^9, 3.736762021718416*^9, 
   3.736762883878646*^9, 3.7368460173091793`*^9, 3.736919768957389*^9, 
   3.7370123133117228`*^9, 3.737171736729178*^9, 3.73717398679391*^9, 
   3.7372635884170628`*^9},ExpressionUUID->"939aaed6-a9b3-4be7-bd7c-\
dac0751ffe46"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization of Patients A and B in Gabriel\[CloseCurlyQuote]s case \
report", "Section",
 CellChangeTimes->{{3.734234811014934*^9, 3.73423484001469*^9}, {
  3.734744655911356*^9, 
  3.734744661830208*^9}},ExpressionUUID->"961243a1-409d-4a15-b95f-\
41d2616d593b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LoadClinicalDataSpec", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "path", ",", "file"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"path", "=", 
       RowBox[{
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
        "\"\</ClinicalData/\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"file", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "2"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "2"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"file", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"Import", "[", 
              RowBox[{"path", "<>", "\"\<Gabriel-\>\"", "<>", 
               RowBox[{"ToString", "[", " ", "i", "]"}], "<>", 
               "\"\<.png-data-\>\"", "<>", 
               RowBox[{"ToString", "[", "j", "]"}], "<>", 
               "\"\<-spectra.dat\>\""}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "file", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadClinicalDataDynamics", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "path", ",", "file"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"path", "=", 
       RowBox[{
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
        "\"\</ClinicalData/\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"file", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "2"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "2"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"file", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"Import", "[", 
              RowBox[{"path", "<>", "\"\<Gabriel-\>\"", "<>", 
               RowBox[{"ToString", "[", " ", "i", "]"}], "<>", 
               "\"\<.png-data-\>\"", "<>", 
               RowBox[{"ToString", "[", "j", "]"}], "<>", 
               "\"\<-spectra.dat\>\""}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "file", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solSS1", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Eq1s", ",", "Eq2s", ",", "Eq3s", ",", "Eq4s", ",", "sol", ",", "s", 
       ",", "n", ",", "p", ",", "s00", ",", "n00", ",", "p00", ",", "tf"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Eq1s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq1", "[", 
        RowBox[{"s", ",", "n", ",", "r", ",", "p", ",", "s"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq2s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq2", "[", 
        RowBox[{"s", ",", "n", ",", "s", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq3s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq3", "[", 
        RowBox[{"s", ",", "r", ",", "s", ",", "r"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq4s", "[", 
        RowBox[{"s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq4", "[", 
        RowBox[{"s", ",", "p", ",", "s", ",", "p", ",", "s", ",", "p"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"solODE", "[", 
        RowBox[{"s0", ",", "n0", ",", "p0", ",", "300"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"s", "/.", 
             RowBox[{"sol", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "@", 
           RowBox[{"Domain", "[", "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s00", ",", "n00", ",", "p00"}], "}"}], "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "/.", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "200", ",", "300", ",", "5"}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Eq1s", "[", 
             RowBox[{"s", ",", "n", ",", "p"}], "]"}], "\[Equal]", "0"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq2s", "[", 
             RowBox[{"s", ",", "n", ",", "p"}], "]"}], "\[Equal]", "0"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq4s", "[", 
             RowBox[{"s", ",", "n", ",", "p"}], "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "n00"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "s00"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "p00"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"para2", "[", "para_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Abs", "[", "para", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PS", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PM", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]P", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]var4", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"APmax", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDEop", "[", 
    RowBox[{
    "s00_", ",", "n00_", ",", "p00_", ",", "tf_", ",", "per_", ",", "amp1_", 
     ",", "amp2_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r00", ",", "sol", ",", "a1", ",", "a2", ",", "a3", ",", "Eq1b", ",", 
       "Eq2b", ",", "Eq3b", ",", "Eq4b"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
              RowBox[{"n", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], " ", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "n00"}], " ", ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            RowBox[{"p00", " ", "amp1", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"amp2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"2", "\[Pi]", " ", 
                   RowBox[{"t", "/", "per"}]}], "+", 
                  RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               RowBox[{"-", "0.000000001"}]}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.00001"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ObjFunction", "[", 
    RowBox[{"var_", ",", "parameter_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", 
       "\[Tau]PS", ",", "\[Tau]PM", ",", "\[Gamma]P", ",", "\[Theta]var4", 
       ",", "APmax", ",", "sol", ",", "tf", ",", "per", ",", "amp1", ",", 
       "amp2", ",", "sol1", ",", "sol2", ",", "s01", ",", "n01", ",", "p01", 
       ",", "J", ",", "J1", ",", "J2", ",", "tMax1", ",", "tMax2", ",", 
       "tMax", ",", "patientID"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"Abs", "[", "var", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"para2", "[", "b", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tf", "=", "6000"}], ";", "\[IndentingNewLine]", 
      RowBox[{"per", "=", 
       RowBox[{"b", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"amp1", "=", 
       RowBox[{"b", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"amp2", "=", 
       RowBox[{"b", "[", 
        RowBox[{"[", "10", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
        RowBox[{"solSS1", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol1", "=", 
       RowBox[{"solDDEop", "[", 
        RowBox[{
        "s01", ",", "n01", ",", "p01", ",", "tf", ",", "per", ",", "amp1", 
         ",", "amp2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol1", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FitnessFunction", "[", 
     RowBox[{"var_", ",", "parameter_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "sol1", ",", "sol2", ",", "tMax1", ",", 
        "tMax2", ",", "J1", ",", "J2", ",", "b1", ",", "b2", ",", 
        "patientID"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"patientID", "=", "parameter"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Fitno", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol1", "=", 
        RowBox[{"ObjFunction", "[", 
         RowBox[{"var", ",", "parameter"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tMax1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "/.", 
              RowBox[{"sol1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "@", 
            RowBox[{"Domain", "[", "]"}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"tMax1", "<", "5500"}], ",", "\[IndentingNewLine]", 
         RowBox[{"b1", "=", "100000000000."}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"J1", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", 
                RowBox[{"n", "[", "t", "]"}], ",", "0", ",", 
                RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
              RowBox[{"sol1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "tMax1", ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"MSet", "[", 
           RowBox[{"\"\<solution\>\"", ",", "J1"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"MSet", "[", 
           RowBox[{"\"\<patient\>\"", ",", "patientID"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "MEvaluate", "[", 
           "\"\<err=compare_clinical_data(solution,patient,all_data);\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"b1", "=", 
           RowBox[{"MGet", "[", "\"\<err\>\"", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"b2", "=", "100000000."}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"1", "/", 
         RowBox[{"Min", "[", 
          RowBox[{"b1", ",", "b2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"b", ">", "1.3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"path", "<>", "\"\<FittingResult-parameters-\>\"", "<>", 
             RowBox[{"ToString", "[", "patientID", "]"}], "<>", "\"\<-\>\"", "<>", 
             RowBox[{"ToString", "[", "Fitno", "]"}], "<>", "\"\<.dat\>\""}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "b", "}"}], ",", "var"}], "]"}], "}"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "b", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.734139687876865*^9, 3.734139761362412*^9}, {
   3.73414364572476*^9, 3.734143717151738*^9}, {3.734143859905752*^9, 
   3.73414390441389*^9}, {3.7341440082661877`*^9, 3.734144015601324*^9}, {
   3.734144132790766*^9, 3.734144147375009*^9}, {3.734144192378632*^9, 
   3.734144219325788*^9}, {3.734144763310614*^9, 3.734144816870269*^9}, {
   3.734144847133676*^9, 3.734144860342593*^9}, {3.7341454709892273`*^9, 
   3.734145623590856*^9}, {3.734145702618347*^9, 3.73414575736623*^9}, {
   3.734146221317477*^9, 3.734146290780685*^9}, {3.734146346168542*^9, 
   3.7341463485882893`*^9}, {3.7341467938704653`*^9, 3.734146822243828*^9}, 
   3.734147505941389*^9, {3.734147535973775*^9, 3.734147629442298*^9}, {
   3.734148013922208*^9, 3.734148081865888*^9}, {3.734148122476678*^9, 
   3.734148164329928*^9}, {3.734153059631901*^9, 3.734153059883582*^9}, {
   3.7341530929491167`*^9, 3.7341530943918962`*^9}, {3.734153241288988*^9, 
   3.734153250510807*^9}, {3.734153301449478*^9, 3.734153307248891*^9}, {
   3.734153381281795*^9, 3.734153395257559*^9}, {3.73415347632482*^9, 
   3.7341535668580627`*^9}, {3.734154209842443*^9, 3.7341542383638372`*^9}, {
   3.7341542878012123`*^9, 3.734154375086591*^9}, {3.734154409466186*^9, 
   3.7341545446880198`*^9}, {3.73415457570829*^9, 3.734154884556901*^9}, {
   3.734154933392579*^9, 3.7341550148757277`*^9}, {3.734155232290049*^9, 
   3.7341552651650057`*^9}, {3.7341553470384197`*^9, 3.734155461865101*^9}, {
   3.734155492901327*^9, 3.73415549664889*^9}, {3.734155534567131*^9, 
   3.734155674681535*^9}, {3.734155762157504*^9, 3.734156104010497*^9}, {
   3.7341561984354343`*^9, 3.734156237962021*^9}, {3.7341562683430567`*^9, 
   3.734156269084235*^9}, {3.7341563435580893`*^9, 3.734156379245685*^9}, {
   3.734234865798628*^9, 3.734234889514901*^9}, {3.734235841131824*^9, 
   3.734235853754191*^9}, {3.7342367050787897`*^9, 3.734236734875667*^9}, {
   3.734237180563485*^9, 3.734237182542953*^9}, {3.7342374754042788`*^9, 
   3.7342375690552387`*^9}, {3.734237660564372*^9, 3.7342376630619717`*^9}, {
   3.734237871443561*^9, 3.734237881898074*^9}, {3.7342381117153053`*^9, 
   3.7342381262631187`*^9}, {3.734663658405444*^9, 3.734663696757533*^9}, {
   3.7346643623202877`*^9, 3.73466437357275*^9}, {3.73466562318814*^9, 
   3.734665650085672*^9}, {3.734665702488427*^9, 3.7346657272881413`*^9}, {
   3.734666110468101*^9, 3.7346661979949903`*^9}, {3.734666280615581*^9, 
   3.734666308144958*^9}, {3.734666457054961*^9, 3.7346664812641697`*^9}, {
   3.734666516586363*^9, 3.734666581783594*^9}, {3.7346666359420033`*^9, 
   3.734666643847003*^9}, {3.7347440048840837`*^9, 3.7347440088138037`*^9}, {
   3.734745438062896*^9, 3.734745445619542*^9}, {3.7348475452682343`*^9, 
   3.7348475486801043`*^9}, {3.734847730872994*^9, 3.7348477386524487`*^9}, {
   3.734853488104333*^9, 3.734853525293055*^9}, 3.734859444926503*^9, {
   3.7348597731426897`*^9, 3.7348597770825367`*^9}, 3.73486008647831*^9, {
   3.734860118992382*^9, 3.734860153975896*^9}, {3.735267582715014*^9, 
   3.735267631014022*^9}, {3.7352679201061707`*^9, 3.735267920426672*^9}, {
   3.735274359319765*^9, 3.735274360486169*^9}, {3.735274530694091*^9, 
   3.7352745529198437`*^9}, {3.735274824997167*^9, 3.735274872176512*^9}, {
   3.7352749649538193`*^9, 3.735275005050043*^9}, {3.7352751372477427`*^9, 
   3.7352751635131397`*^9}, {3.7352752238986807`*^9, 
   3.7352753961319647`*^9}, {3.735275456607765*^9, 3.735275505600052*^9}, {
   3.735275629251419*^9, 3.735275669909515*^9}, {3.735275892663378*^9, 
   3.735275895639535*^9}, {3.735276355720047*^9, 3.7352764269986753`*^9}, {
   3.7352765003405657`*^9, 3.735276500564328*^9}, {3.735276540922027*^9, 
   3.735276543054138*^9}, {3.7352950486627502`*^9, 3.735295048905167*^9}, {
   3.7352953229404697`*^9, 3.735295326567767*^9}, {3.735296639239094*^9, 
   3.735296654451713*^9}, {3.7352967049959583`*^9, 3.7352967084437027`*^9}, {
   3.7352971616083393`*^9, 3.7352971692754393`*^9}, {3.7352971997329693`*^9, 
   3.735297209771564*^9}, {3.7352972520210648`*^9, 3.735297260700437*^9}, {
   3.735297457110631*^9, 3.735297465283284*^9}, 3.735297496322095*^9, {
   3.735297779133041*^9, 3.7352977828879633`*^9}, {3.735299012931774*^9, 
   3.73529903862219*^9}, {3.735299782047113*^9, 3.735299807946477*^9}, {
   3.735299862913424*^9, 3.7352998768936996`*^9}, {3.735299911294341*^9, 
   3.735299918939321*^9}, {3.735299997682028*^9, 3.735300004018642*^9}, {
   3.735300083231896*^9, 3.735300086053932*^9}, {3.735300168558888*^9, 
   3.735300168751886*^9}, {3.735337510241975*^9, 3.735337529532703*^9}, {
   3.735338707414317*^9, 3.7353387320725727`*^9}, 3.735338837686192*^9, {
   3.735339019671866*^9, 3.7353390220170116`*^9}, 3.735339173093788*^9, {
   3.735339245429194*^9, 3.735339261724608*^9}, {3.7353399564664*^9, 
   3.7353399640505877`*^9}, {3.73534172141463*^9, 3.735341833492209*^9}, {
   3.7353427563433123`*^9, 3.735342757396676*^9}, {3.7353530393289967`*^9, 
   3.73535304265408*^9}, {3.7353531206489887`*^9, 3.735353131144498*^9}, {
   3.735353295818523*^9, 3.7353533051462393`*^9}, {3.73535340266669*^9, 
   3.735353428219965*^9}, {3.735353664334557*^9, 3.735353714532508*^9}, {
   3.735353746159871*^9, 3.735353755414912*^9}, {3.73535463862403*^9, 
   3.735354689034155*^9}, {3.735354723679071*^9, 3.735354787319253*^9}, {
   3.7353549103158493`*^9, 3.7353549118934593`*^9}, {3.735354985174787*^9, 
   3.73535499289076*^9}, {3.735355507210191*^9, 3.735355511022304*^9}, {
   3.735359007804288*^9, 3.7353590135208597`*^9}, {3.7353591955572577`*^9, 
   3.735359217029508*^9}, {3.735359861372369*^9, 3.735359861873728*^9}, {
   3.735360183724463*^9, 3.735360183868621*^9}, {3.735360253981545*^9, 
   3.735360296177001*^9}, {3.7353814835290833`*^9, 3.735381484133608*^9}, {
   3.7353846481083384`*^9, 3.73538465665244*^9}, 3.7353871153686247`*^9, {
   3.735387402149083*^9, 3.73538740621565*^9}, {3.7353885099069633`*^9, 
   3.7353885103664837`*^9}, 3.735418267290339*^9, {3.735518235901403*^9, 
   3.735518238257729*^9}, {3.735529062739129*^9, 3.735529063136282*^9}, {
   3.735531917123637*^9, 3.73553194580462*^9}, {3.735619248078665*^9, 
   3.735619292969623*^9}, {3.735619623012197*^9, 3.735619638607122*^9}, {
   3.7356201383280373`*^9, 3.735620146568801*^9}, {3.7356202592693157`*^9, 
   3.735620262341638*^9}, {3.735647997150107*^9, 3.7356480064035273`*^9}, {
   3.735705075796906*^9, 3.735705116023232*^9}, {3.735705723917499*^9, 
   3.735705742896735*^9}, {3.735705922548308*^9, 3.735705925795772*^9}, {
   3.735708279041449*^9, 3.7357082873456783`*^9}, {3.735708700690414*^9, 
   3.735708700938642*^9}, {3.735709243270043*^9, 3.735709247851861*^9}, {
   3.735709284447698*^9, 3.735709296501215*^9}, {3.735814875661656*^9, 
   3.735814881323101*^9}, {3.735815190892995*^9, 3.735815194296556*^9}, {
   3.735858650410965*^9, 3.7358587047593803`*^9}, {3.735859232657645*^9, 
   3.735859273498498*^9}, {3.7358594384263153`*^9, 3.735859439935412*^9}, {
   3.7358598745625877`*^9, 3.735859947485848*^9}, {3.73586069923158*^9, 
   3.7358607651302643`*^9}, {3.735860833790791*^9, 3.735860857467031*^9}, {
   3.7358609229443903`*^9, 3.735860923182423*^9}, {3.735863432421557*^9, 
   3.735863443993321*^9}, {3.7358634758368073`*^9, 3.735863493560128*^9}, {
   3.735898497091386*^9, 3.735898498743204*^9}, {3.736250859116334*^9, 
   3.736250859409882*^9}, {3.7363161945986013`*^9, 3.736316213583291*^9}, {
   3.736316274919639*^9, 3.736316278621574*^9}, {3.736316539874179*^9, 
   3.736316566113456*^9}, 3.736319883915153*^9, 3.736380022550878*^9, {
   3.750719336780305*^9, 
   3.750719337126749*^9}},ExpressionUUID->"5bf09a50-4e26-4931-a24d-\
777b7a658e5e"],

Cell[CellGroupData[{

Cell["Run", "Subsection",
 CellChangeTimes->{{3.735706870640864*^9, 
  3.735706871109684*^9}},ExpressionUUID->"cd4775fc-9b4d-4e67-aea0-\
3ade2ece67f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OpenMATLAB", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "patientID", ",", "Fitno", ",", "interation",
     ",", "popno", ",", "step", ",", "size", ",", "pid"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClinicalFile", "=", 
   RowBox[{
    RowBox[{"ParentDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
    "\"\</ClinicalData/Gabriel_data_property.mat\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path1", "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</plotting/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MEvaluate", "[", "\"\<clear all;clear;clc;close all;\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MEvaluate", "[", 
   RowBox[{
   "\"\<load('\>\"", "<>", "ClinicalFile", "<>", "\"\<','all_data');\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MFunction", "[", "\"\<cd\>\"", "]"}], "[", "path1", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<11\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pid", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pid", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"10", "^", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"0", ",", "0.3"}], "]"}], ",", "7"}], "]"}]}], ")"}], 
           
           RowBox[{"{", 
            RowBox[{
            "0.135185507751061", ",", "2.94974079254110", ",", 
             "0.830685961047449", ",", "14.9695072692383", ",", 
             "0.676946146382255", ",", "4.24504789237303", ",", 
             "733274.262606207"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"10", "^", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"0", ",", "0.3"}], "]"}], ",", "7"}], "]"}]}], ")"}], 
           
           RowBox[{"{", 
            RowBox[{
            "0.05856191836589745`", ",", "3.8704055259125036`", ",", 
             "1.0953868040154175`", ",", "18.9780348899218`", ",", 
             "1.1201492296681004`", ",", "9.209142977188922`", ",", 
             "1.9055074655519796`*^6"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"10", "^", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"0", ",", "0.3"}], "]"}], ",", "7"}], "]"}]}], ")"}], 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.02", " ", "0.05856191836589745`"}], ",", 
             "3.8704055259125036`", ",", "1.0953868040154175`", ",", 
             RowBox[{"0.96", " ", "18.9780348899218`"}], ",", " ", 
             "1.1201492296681004`", ",", " ", "9.209142977188922`", ",", 
             "1.9055074655519796`*^6"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "15"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a1", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"initialpop", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0.05856191836589745`", ",", "3.8704055259125036`", ",", 
            "1.0953868040154175`", ",", "18.9780348899218`", ",", 
            "1.1201492296681004`", ",", "9.209142977188922`", ",", 
            "1.9055074655519796`*^6", ",", "30", ",", "1", ",", "0.01`"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "0.135185507751061", ",", "2.94974079254110", ",", 
            "0.830685961047449", ",", "14.9695072692383", ",", 
            "0.676946146382255", ",", "4.24504789237303", ",", "733274", ",", 
            "30", ",", "1", ",", "0.00001"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.02", " ", "0.05856191836589745`"}], ",", 
            "3.8704055259125036`", ",", "1.0953868040154175`", ",", 
            "18.21891349432493`", ",", " ", "1.1201492296681004`", ",", " ", 
            "9.209142977188922`", ",", "1.9055074655519796`*^6", ",", "30", 
            ",", "1", ",", "0.00001"}], "}"}]}], "}"}], ",", "a1", ",", "a2", 
        ",", "a3"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"pid", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.0689477291890606", ",", "0.709139456360246", ",", 
          "7.90433947062231", ",", "26.4758822402084", ",", 
          "0.110887533704568", ",", "11.9972822637389", ",", 
          "198564.701292912"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.0432021184646569", ",", "0.0240707200330078", ",", 
          "8.47539094009678", ",", "3.24568567061769", ",", 
          "1.42920158598576", ",", "2.73280736582839", ",", 
          "3588265.03777331"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.401941826683566", ",", "0.0429523890368097", ",", 
          "4.44727522740377", ",", "105.300044185953", ",", 
          "0.00693069876571556", ",", "21.0182437019553", ",", 
          "329586.101859294"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.0423223844038119", ",", "1.73924527513850", ",", 
          "0.702785625081746", ",", "12.7790816568063", ",", 
          "0.236536965648941", ",", "9.59683971349143", ",", 
          "2319000.33911768"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.0583830234738155", ",", "1.32118449831816", ",", 
          "1.51805820400785", ",", "3.21757875909807", ",", 
          "1.35598031504396", ",", "225.841610556788", ",", 
          "1301600.27364319"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"initialpop", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "1", ",", "0.001"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "a", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"10", "^", 
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", 
                   RowBox[{"0", ",", "0.3"}], "]"}], ",", "7"}], "]"}]}], 
               ")"}], 
              RowBox[{"a", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"30", ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"initialpop", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"initialpop", ",", "a1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"a", ",", "a1", ",", "a2", ",", "a3"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"a", "=", 
  RowBox[{"GenereicMain", "[", 
   RowBox[{"initialpop", ",", 
    RowBox[{"N", "[", "0.000001", "]"}], ",", "step", ",", "size", ",", 
    "path", ",", "pid"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"a", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s", "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "@", 
       RowBox[{"Domain", "[", "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"s", "[", "t", "]"}], ",", 
        RowBox[{"n", "[", "t", "]"}], ",", 
        RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tf"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "[", "t", "]"}], "/.", "sol"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "t", "]"}], "/.", "sol"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1000", ",", "2600"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "\"\<FittingResult-md-\>\"", "<>", 
    RowBox[{"ToString", "[", "patientID", "]"}], "<>", "\"\<.dat\>\""}], ",", 
   "J"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "\"\<FittingResult-parameters-\>\"", "<>", 
    RowBox[{"ToString", "[", "patientID", "]"}], "<>", "\"\<.dat\>\""}], ",", 
   
   RowBox[{"a", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"1", "/", 
  RowBox[{"FitnessFunction", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}], ",", "pid"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseMATLAB", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.735353635483601*^9, {3.735353740353354*^9, 3.7353538078484783`*^9}, 
   3.735354920024515*^9, {3.7353565175547132`*^9, 3.735356530479678*^9}, {
   3.735357058719583*^9, 3.7353570632871037`*^9}, {3.735359867887919*^9, 
   3.735359870821768*^9}, 3.7353608402675657`*^9, 3.735361873271343*^9, {
   3.7353819698551064`*^9, 3.735381972522065*^9}, {3.7353822008315887`*^9, 
   3.735382204008604*^9}, 3.735382617078676*^9, {3.7353826537574043`*^9, 
   3.735382686053334*^9}, {3.7353833430003967`*^9, 3.735383344019964*^9}, 
   3.7353841379891167`*^9, {3.735384666403377*^9, 3.735384667881575*^9}, {
   3.7353847206740007`*^9, 3.735384727397854*^9}, {3.7353870768537607`*^9, 
   3.735387082707011*^9}, {3.735387301551038*^9, 3.7353873979259*^9}, {
   3.735387438082179*^9, 3.735387516612433*^9}, {3.73538831074695*^9, 
   3.735388337860751*^9}, {3.735388410264333*^9, 3.7353884109810057`*^9}, {
   3.735388517044732*^9, 3.735388535147636*^9}, {3.7353885947045527`*^9, 
   3.735388595799803*^9}, {3.735416802890204*^9, 3.735416818865337*^9}, {
   3.7355145227185373`*^9, 3.735514544076681*^9}, {3.735517657221616*^9, 
   3.73551766054246*^9}, {3.7355177069107943`*^9, 3.73551771535555*^9}, {
   3.735526459302885*^9, 3.735526495134246*^9}, {3.735600268754318*^9, 
   3.735600269702177*^9}, {3.735603428005733*^9, 3.735603456808189*^9}, {
   3.735608103021522*^9, 3.735608123852503*^9}, {3.735610449079913*^9, 
   3.735610458033368*^9}, {3.7356106123256207`*^9, 3.735610615903768*^9}, {
   3.7356174613332157`*^9, 3.735617487108076*^9}, {3.7356175379193583`*^9, 
   3.735617550531103*^9}, {3.735617643296219*^9, 3.7356176440576067`*^9}, {
   3.735617848805038*^9, 3.735617872492935*^9}, {3.7356180745709133`*^9, 
   3.735618100232212*^9}, {3.735618158395479*^9, 3.7356181712932997`*^9}, 
   3.735618265455562*^9, {3.7356183733019743`*^9, 3.735618383889776*^9}, {
   3.735619442338512*^9, 3.735619442495924*^9}, {3.735619774077104*^9, 
   3.735619810147887*^9}, {3.7356201015637093`*^9, 3.735620112101709*^9}, {
   3.7356466817282763`*^9, 3.735646682268561*^9}, {3.735646844543305*^9, 
   3.7356468454154797`*^9}, {3.735648777556848*^9, 3.735648777908259*^9}, {
   3.7356490086348333`*^9, 3.7356490202044153`*^9}, {3.7356958701469803`*^9, 
   3.735695887373962*^9}, {3.735696269400741*^9, 3.735696285706904*^9}, {
   3.735703292658761*^9, 3.735703303454811*^9}, {3.735706106516059*^9, 
   3.7357061066708193`*^9}, {3.735706412878751*^9, 3.7357064178037987`*^9}, {
   3.735707576784424*^9, 3.735707577119512*^9}, 3.735708042691578*^9, {
   3.7357081478720007`*^9, 3.735708148315094*^9}, {3.7357084106093063`*^9, 
   3.735708414750516*^9}, {3.735708785004745*^9, 3.7357088087950478`*^9}, {
   3.735709011927652*^9, 3.735709012529456*^9}, {3.735709611542988*^9, 
   3.7357096188910513`*^9}, {3.735710046962453*^9, 3.735710047155931*^9}, {
   3.7357811911914186`*^9, 3.73578119714631*^9}, 3.7357812352983313`*^9, {
   3.735781813599369*^9, 3.735781835444366*^9}, 3.735781947355579*^9, {
   3.735782537581551*^9, 3.735782543568407*^9}, {3.735789137385228*^9, 
   3.7357891411311483`*^9}, {3.735790653945774*^9, 3.7357906544348593`*^9}, {
   3.735790882796318*^9, 3.7357908882677298`*^9}, {3.735791381843821*^9, 
   3.735791382593855*^9}, {3.7357919343763733`*^9, 3.7357919359731483`*^9}, {
   3.7358153505824327`*^9, 3.735815356634012*^9}, {3.735816158961121*^9, 
   3.735816161592613*^9}, {3.7358167702845373`*^9, 3.7358167928651114`*^9}, 
   3.7358176732934732`*^9, {3.735817844971807*^9, 3.735817852766852*^9}, 
   3.735818468399707*^9, {3.735821024616647*^9, 3.735821025575706*^9}, {
   3.735821330787101*^9, 3.735821349596799*^9}, {3.735821531245575*^9, 
   3.735821541353525*^9}, {3.7358217110189753`*^9, 3.735821715362632*^9}, 
   3.7358219900060062`*^9, {3.735822245895932*^9, 3.735822265542905*^9}, {
   3.735854888954125*^9, 3.7358548891913147`*^9}, {3.735855445663229*^9, 
   3.7358554526792707`*^9}, {3.73585713719841*^9, 3.7358571373727283`*^9}, 
   3.7358574929597063`*^9, {3.735858583253558*^9, 3.735858596835743*^9}, {
   3.735858876180567*^9, 3.7358588937038927`*^9}, {3.7358589246596212`*^9, 
   3.735858945032317*^9}, {3.7358614294304028`*^9, 3.735861462731791*^9}, 
   3.73586217556695*^9, {3.735863518816945*^9, 3.735863538501902*^9}, {
   3.7358728210724297`*^9, 3.735872821503847*^9}, {3.735878533466393*^9, 
   3.735878533886951*^9}, {3.735886839601206*^9, 3.735886839787039*^9}, 
   3.735894354382259*^9, {3.735894866431985*^9, 3.7358948669400663`*^9}, {
   3.735895281369505*^9, 3.735895282255488*^9}, {3.7358955599891663`*^9, 
   3.7358955651869373`*^9}, {3.735896459367177*^9, 3.7358964597752647`*^9}, {
   3.73589849875594*^9, 3.735898499142297*^9}, {3.7358985676068153`*^9, 
   3.7358985756815033`*^9}, {3.735898610962118*^9, 3.735898620335292*^9}, {
   3.735898997696516*^9, 3.735898998085144*^9}, {3.735901370796472*^9, 
   3.7359013956218643`*^9}, {3.7359022312144327`*^9, 3.735902257510098*^9}, {
   3.735902527101993*^9, 3.735902527266199*^9}, {3.7359030900576363`*^9, 
   3.735903098574662*^9}, 3.735903369773037*^9, {3.7363162855350113`*^9, 
   3.736316285822472*^9}, {3.736319890107956*^9, 3.736319890630072*^9}, {
   3.736379072569874*^9, 3.736379107615782*^9}, {3.736381026131301*^9, 
   3.736381026568025*^9}, {3.736383219630577*^9, 3.7363832355280123`*^9}, {
   3.736402870426717*^9, 3.7364029018233852`*^9}, 3.736403339144486*^9, {
   3.7364035318373632`*^9, 3.736403534829954*^9}, {3.7364649652144012`*^9, 
   3.7364649654150743`*^9}, {3.736465992725268*^9, 3.736466000326294*^9}, {
   3.736473525696363*^9, 3.736473539915248*^9}, {3.7364760644566927`*^9, 
   3.736476105256543*^9}, {3.73647730026156*^9, 3.736477303203648*^9}, {
   3.736479887774158*^9, 3.736479902132036*^9}, {3.736479945019617*^9, 
   3.7364799454615707`*^9}, {3.736507108310643*^9, 3.7365071386879683`*^9}, {
   3.736507174399589*^9, 3.73650718606168*^9}, 3.736507385913579*^9, {
   3.736507598208459*^9, 3.736507623808373*^9}, {3.7365410373372383`*^9, 
   3.736541057576029*^9}, {3.73654307278757*^9, 3.7365430811936197`*^9}, {
   3.7365431122822943`*^9, 3.736543133054784*^9}, {3.7365441389727507`*^9, 
   3.736544141157775*^9}, {3.7366556169250193`*^9, 3.736655655995405*^9}, {
   3.736655729609461*^9, 3.736655778596627*^9}, {3.736656177674964*^9, 
   3.7366562227984343`*^9}, {3.7366568519773207`*^9, 3.7366568552855577`*^9}, 
   3.736854527248514*^9, {3.736854558647756*^9, 3.736854559671423*^9}, {
   3.736920591562048*^9, 3.736920591710156*^9}, {3.736923444867057*^9, 
   3.736923483958651*^9}, {3.7369235360982513`*^9, 3.736923631628174*^9}, {
   3.7369236676443663`*^9, 3.736923874462295*^9}, {3.736923904616764*^9, 
   3.736923905250269*^9}, {3.73692393792451*^9, 3.7369240035141983`*^9}, {
   3.736924052359283*^9, 3.736924058095767*^9}, {3.736927894895603*^9, 
   3.736927917270194*^9}, {3.736928067040186*^9, 3.736928107751758*^9}, {
   3.736928138415514*^9, 3.7369281552242393`*^9}, {3.750719362816247*^9, 
   3.7507194048716383`*^9}},ExpressionUUID->"40fcb034-ace1-4788-aaec-\
fd105ed20ac5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization paths", "Section",
 CellChangeTimes->{{3.735706839246811*^9, 
  3.7357068506622458`*^9}},ExpressionUUID->"1ea9deee-0542-4f68-b6fc-\
8dd46f7a72b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "parafit", ",", "i", ",", "j", ",",
     "k", ",", "tf", ",", "tMax"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<11\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDEop1", "[", 
    RowBox[{
    "s00_", ",", "n00_", ",", "p00_", ",", "tf_", ",", "per_", ",", "amp1_", 
     ",", "amp2_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r00", ",", "sol", ",", "a1", ",", "a2", ",", "a3", ",", "Eq1b", ",", 
       "Eq2b", ",", "Eq3b", ",", "Eq4b"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
              RowBox[{"n", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], " ", ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            RowBox[{"n00", "  ", "amp1", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"amp2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"2", "\[Pi]", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "+", "8"}], ")"}], "/", "per"}]}], "+", 
                  RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "3.5"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            RowBox[{"p00", " ", "amp1", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"amp2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"2", "\[Pi]", " ", 
                   RowBox[{"t", "/", "per"}]}], "+", 
                  RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               RowBox[{"-", "0.000000001"}]}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.00001"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "1000"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", "2.5"}], ";", "0.5", ";", "0.95", ";", "0.55", ";", 
  "1.06", ";", "1.15", ";", "1.2", ";", "1.01", ";", "0.695", ";", "0.85", 
  ";", "0.9", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetPara", "[", "i_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"parafit", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0.10288157818520864`", ",", "106.43615196259387`", ",", 
              "0.5476934020077088`", ",", "18.9780348899218`", ",", 
              "4.928656610539642`", ",", "9.209142977188922`", ",", 
              "2.0579480627961378`*^6", ",", "30", ",", "1", ",", 
              "0.07103989546756488`"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "0.08967929230529154`", ",", "8.457599246447119`", ",", 
              "0.6616536725137344`", ",", "15.880004943743236`", ",", 
              "0.6431948173897128`", ",", "9.44980198745574`", ",", 
              "2.271252925982388`*^6", ",", "30", ",", "1", ",", "0.01`"}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "0.135185507751061`", ",", "2.9497407925411`", ",", 
              "0.830685961047449`", ",", "14.9695072692383`", ",", 
              "0.676946146382255`", ",", "4.24504789237303`", ",", 
              "645281.3510934622`", ",", "30", ",", "1", ",", "0.`"}], 
             "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tf", "=", "10000"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"parafit", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0.08721887742416166`", ",", "0.8766613006210305`", ",", 
              "6.323471576497848`", ",", "9.26655878407294`", ",", 
              "0.27721883426142`", ",", "11.9972822637389`", ",", 
              "471591.165570666`", ",", "30", ",", "1", ",", "0.001`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0.372", ",", "0.8766613006210305`", ",", "6.323471576497848`", 
              ",", "9.26655878407294`", ",", "0.27721883426142`", ",", 
              "11.9972822637389`", ",", "471591.165570666`", ",", "30", ",", 
              "1", ",", "0.001`"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tf", "=", "10000"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"i", "=", "2"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"J", ",", "sol"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientID", "=", "i"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetPara", "[", "i", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"parafit", "[", 
    RowBox[{"[", "1", " ", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "b", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"para2", "[", "b", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"per", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp1", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp2", "=", 
   RowBox[{"b", "[", 
    RowBox[{"[", "10", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
    RowBox[{"solSS1", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"solDDEop1", "[", 
    RowBox[{
    "s01", ",", "n01", ",", "p01", ",", "tf", ",", "per", ",", "amp1", ",", 
     "amp2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "[", "t", "]"}], "/.", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"p", "[", "t", "]"}], "/.", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"tf", "-", "100"}], ",", "tf"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"n", "[", "t", "]"}], "/.", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tf"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "}"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"s", "[", "t", "]"}], ",", 
        RowBox[{"p", "[", "t", "]"}], ",", 
        RowBox[{"n", "[", "t", "]"}]}], "}"}], "/.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tf"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"path", "<>", "\"\<FittingResult-md-\>\"", "<>", 
     RowBox[{"ToString", "[", "PatientID", "]"}], "<>", "\"\<.dat\>\""}], ",",
     "J"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "\"\<FittingResult-parameters-\>\"", "<>", 
    RowBox[{"ToString", "[", "PatientID", "]"}], "<>", "\"\<-\>\"", "<>", 
    RowBox[{"ToString", "[", "Now", "]"}], "<>", "\"\<.dat\>\""}], ",", "b", 
   ",", "\"\<csv\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"a", ",", "b", ",", "parafit"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.735704797130559*^9, 3.735704797328438*^9}, 
   3.735704943640274*^9, {3.7357049874183598`*^9, 3.7357049876488867`*^9}, 
   3.735705819795908*^9, {3.735706687183934*^9, 3.735706789700129*^9}, 
   3.7357068532180023`*^9, 3.735707492129282*^9, {3.735707705104409*^9, 
   3.735707805303103*^9}, {3.735708629082838*^9, 3.735708667744911*^9}, {
   3.735708762230218*^9, 3.735708778071006*^9}, {3.735709188919448*^9, 
   3.735709201396049*^9}, 3.7357094102367907`*^9, 3.7357821295368557`*^9, 
   3.735817643988604*^9, {3.735817700826394*^9, 3.735817705644393*^9}, {
   3.735817762287285*^9, 3.735817770860393*^9}, {3.735817961396884*^9, 
   3.735817961578071*^9}, {3.735817997178947*^9, 3.735818021898429*^9}, 
   3.7358212927932777`*^9, 3.735821386267139*^9, 3.735821479716078*^9, {
   3.735857079010725*^9, 3.735857102136648*^9}, {3.735867074491238*^9, 
   3.735867088736858*^9}, {3.7358671225234118`*^9, 3.735867122975007*^9}, {
   3.73587760135147*^9, 3.7358776082022448`*^9}, 3.7358777642482853`*^9, 
   3.7358785630743923`*^9, 3.735894649886612*^9, 3.735894786682675*^9, 
   3.735895941293954*^9, {3.73589602133152*^9, 3.735896042242465*^9}, 
   3.735896926915534*^9, 3.7358970473479347`*^9, 3.7358970861012506`*^9, 
   3.7358983150384274`*^9, {3.735898370407135*^9, 3.735898385917783*^9}, 
   3.735898426273012*^9, {3.735898475880919*^9, 3.735898476201199*^9}, {
   3.735898524663846*^9, 3.735898553929616*^9}, {3.735898793611075*^9, 
   3.73589881346373*^9}, {3.735899230421693*^9, 3.735899258778458*^9}, {
   3.73589956753377*^9, 3.735899595098406*^9}, {3.735899965453102*^9, 
   3.735900100284306*^9}, {3.735900490724832*^9, 3.735900491056099*^9}, {
   3.735900545405848*^9, 3.735900606462129*^9}, {3.7359008875401373`*^9, 
   3.735900888022212*^9}, {3.7359012163038282`*^9, 3.735901219245891*^9}, {
   3.735901264096324*^9, 3.735901317325541*^9}, {3.735901350548455*^9, 
   3.735901355498267*^9}, 3.735901752681149*^9, {3.73590215443055*^9, 
   3.7359021579409246`*^9}, 3.735902208303413*^9, 3.7359030281748123`*^9, {
   3.735903263352889*^9, 3.735903268698546*^9}, {3.735903319725731*^9, 
   3.735903338812263*^9}, {3.735903404966941*^9, 3.735903416872438*^9}, 
   3.73590363542376*^9, {3.7359037720384283`*^9, 3.7359038749618797`*^9}, {
   3.735903914890277*^9, 3.735903951992824*^9}, {3.735903984001519*^9, 
   3.7359040282098303`*^9}, {3.73590425165726*^9, 3.735904264569965*^9}, {
   3.735904299257613*^9, 3.7359043664120092`*^9}, {3.7359044080456867`*^9, 
   3.7359044094059753`*^9}, {3.735904443208617*^9, 3.735904504959671*^9}, {
   3.735904631078425*^9, 3.735904657382749*^9}, {3.735904700014257*^9, 
   3.735904730802137*^9}, {3.735904918911347*^9, 3.735904920362358*^9}, {
   3.735905003313573*^9, 3.735905062547832*^9}, 3.7359055236186743`*^9, {
   3.735905587367388*^9, 3.7359056115443897`*^9}, {3.735905706036845*^9, 
   3.735905751496636*^9}, {3.73590581899289*^9, 3.735905820046522*^9}, {
   3.7359058780816298`*^9, 3.7359061152920303`*^9}, {3.7359061547942257`*^9, 
   3.735906227545541*^9}, {3.735906281746787*^9, 3.7359062819606323`*^9}, {
   3.7359063124881983`*^9, 3.7359063127028227`*^9}, {3.735906373730748*^9, 
   3.735906374242841*^9}, {3.735906404540167*^9, 3.735906405145082*^9}, {
   3.735906575745289*^9, 3.735906631934054*^9}, {3.7359066956474237`*^9, 
   3.735906736391041*^9}, {3.735906801418778*^9, 3.735906801643914*^9}, {
   3.735906845537176*^9, 3.73590686059411*^9}, {3.7359072327276783`*^9, 
   3.735907253339199*^9}, {3.735907291925478*^9, 3.7359072962441263`*^9}, {
   3.735907332221178*^9, 3.735907349272694*^9}, {3.735907488160262*^9, 
   3.7359075130329313`*^9}, {3.735907639424201*^9, 3.735907709791481*^9}, {
   3.735907809240025*^9, 3.735907891941731*^9}, {3.735907927657597*^9, 
   3.735907941923634*^9}, 3.73590802572491*^9, {3.735908058490151*^9, 
   3.735908059971726*^9}, {3.7359081820765257`*^9, 3.735908232722452*^9}, {
   3.7359083017733107`*^9, 3.735908392679035*^9}, {3.735908458740862*^9, 
   3.735908505766254*^9}, {3.735908584310685*^9, 3.735908599886176*^9}, {
   3.736387639389398*^9, 3.7363876565916233`*^9}, {3.736402761875696*^9, 
   3.7364028282387867`*^9}, 3.736461488984829*^9, {3.7364617734581347`*^9, 
   3.73646177361499*^9}, {3.73646183171774*^9, 3.736461831994338*^9}, {
   3.736461891601719*^9, 3.7364619119353123`*^9}, {3.736462182463348*^9, 
   3.736462259367765*^9}, 3.7364623962909927`*^9, {3.736462463416753*^9, 
   3.7364624719384117`*^9}, {3.736462522131569*^9, 3.736462570514279*^9}, {
   3.736462632333885*^9, 3.736462641795701*^9}, {3.7364626769779587`*^9, 
   3.736462677406399*^9}, {3.736465968484894*^9, 3.73646598492225*^9}, {
   3.736466027008787*^9, 3.7364660393229856`*^9}, {3.736466072244708*^9, 
   3.736466072464529*^9}, {3.736466154701454*^9, 3.7364661918434362`*^9}, {
   3.736466227507946*^9, 3.736466309837426*^9}, {3.736466348784293*^9, 
   3.7364663496278467`*^9}, {3.736478925225814*^9, 3.736478958205065*^9}, {
   3.7364789910552*^9, 3.736479086469998*^9}, {3.736479139319462*^9, 
   3.736479143433341*^9}, {3.7364793162744427`*^9, 3.7364793654706697`*^9}, {
   3.736479405336112*^9, 3.73647951775483*^9}, {3.7364807430941257`*^9, 
   3.736480758017469*^9}, {3.736480791871791*^9, 3.736480817894435*^9}, {
   3.736480868839364*^9, 3.73648086902955*^9}, {3.736480981469006*^9, 
   3.7364810280817347`*^9}, {3.736481287573538*^9, 3.736481393417798*^9}, {
   3.736481441018011*^9, 3.736481571678068*^9}, {3.736481644106703*^9, 
   3.736481663163636*^9}, {3.736481697471157*^9, 3.736481759389875*^9}, {
   3.736481792774745*^9, 3.736481860377762*^9}, {3.736482085640603*^9, 
   3.7364820860332413`*^9}, {3.736482268481578*^9, 3.736482298804297*^9}, {
   3.736482348778803*^9, 3.7364823492439213`*^9}, {3.7364826006061707`*^9, 
   3.736482603643285*^9}, {3.736484547576745*^9, 3.7364845976700563`*^9}, {
   3.736484632958931*^9, 3.736484675779148*^9}, {3.736484779039681*^9, 
   3.736484780028924*^9}, {3.7364849081402884`*^9, 3.736484909121292*^9}, {
   3.736485078313212*^9, 3.736485078721414*^9}, {3.736485217387945*^9, 
   3.736485217823976*^9}, {3.736485323140561*^9, 3.736485366506708*^9}, {
   3.736502359738638*^9, 3.7365024662674723`*^9}, {3.736502511855609*^9, 
   3.7365025193704042`*^9}, {3.736502561199119*^9, 3.736502564989016*^9}, {
   3.736502642567391*^9, 3.736502685721879*^9}, {3.736502745513324*^9, 
   3.736502791025116*^9}, {3.736503325898313*^9, 3.7365033609232817`*^9}, {
   3.736503405273582*^9, 3.736503678612462*^9}, {3.736503708785973*^9, 
   3.736503709290906*^9}, {3.7365045649265003`*^9, 3.736504668863302*^9}, {
   3.736504886168474*^9, 3.7365049277660313`*^9}, {3.736505098969604*^9, 
   3.736505122939838*^9}, {3.736505166833572*^9, 3.736505305187646*^9}, {
   3.7365053443986273`*^9, 3.736505381978518*^9}, {3.7365054756143208`*^9, 
   3.736505558086277*^9}, {3.736505595538746*^9, 3.736505730813511*^9}, {
   3.7365059647946568`*^9, 3.7365059711271067`*^9}, {3.7365060017583723`*^9, 
   3.73650608221889*^9}, {3.7365062012052183`*^9, 3.7365062014198437`*^9}, {
   3.736506241820478*^9, 3.736506264305455*^9}, {3.736506330309041*^9, 
   3.736506334081091*^9}, {3.736506534283239*^9, 3.736506596430625*^9}, {
   3.736506638698584*^9, 3.736506659247204*^9}, {3.736506693948097*^9, 
   3.7365067242293453`*^9}, {3.7365067644387493`*^9, 3.736506806108828*^9}, {
   3.7365068393652*^9, 3.7365068434758997`*^9}, {3.736506882680689*^9, 
   3.736506894552471*^9}, {3.736508067806028*^9, 3.736508073732203*^9}, {
   3.736508719278863*^9, 3.736508719576825*^9}, {3.736508757810677*^9, 
   3.7365087700878687`*^9}, {3.736508801033886*^9, 3.73650881850802*^9}, {
   3.736508849264017*^9, 3.736508849852458*^9}, {3.736508908476684*^9, 
   3.736508909026999*^9}, {3.736509353590126*^9, 3.7365093677275248`*^9}, {
   3.736509417973751*^9, 3.736509445189939*^9}, {3.736509498966791*^9, 
   3.7365094997041273`*^9}, {3.736509529970536*^9, 3.736509612372078*^9}, {
   3.736509659861396*^9, 3.736509692896995*^9}, {3.736509731029811*^9, 
   3.7365098552274437`*^9}, {3.73650988788124*^9, 3.7365099175670433`*^9}, {
   3.736509951158667*^9, 3.736510064390808*^9}, {3.7365101070677423`*^9, 
   3.736510107210205*^9}, {3.7365102084950943`*^9, 3.73651032360572*^9}, {
   3.7365104585160723`*^9, 3.736510460492681*^9}, {3.736510521651132*^9, 
   3.7365105442625504`*^9}, {3.7365106205908833`*^9, 3.736510622163773*^9}, {
   3.7365107634654903`*^9, 3.736510779042305*^9}, {3.736510813139578*^9, 
   3.7365108327538548`*^9}, {3.736510873498526*^9, 3.7365109395656652`*^9}, {
   3.73651097244759*^9, 3.73651100198772*^9}, {3.736511040107216*^9, 
   3.73651104110927*^9}, {3.736511085111986*^9, 3.7365110854777517`*^9}, {
   3.73651112532743*^9, 3.736511126020712*^9}, 3.7365111825302267`*^9, {
   3.7365112322735443`*^9, 3.7365112326190042`*^9}, {3.736511286049115*^9, 
   3.736511287046636*^9}, {3.736511330079267*^9, 3.736511331700058*^9}, {
   3.736511394668788*^9, 3.736511395193037*^9}, {3.7365114516980133`*^9, 
   3.7365114536645403`*^9}, {3.736511541342964*^9, 3.736511559647925*^9}, {
   3.736511603657823*^9, 3.7365116319009457`*^9}, {3.736511676347418*^9, 
   3.7365116765727654`*^9}, {3.7365117092820263`*^9, 
   3.7365117367811832`*^9}, {3.736511800255831*^9, 3.73651180209065*^9}, 
   3.7365119025185337`*^9, {3.736511990150991*^9, 3.736511990377453*^9}, {
   3.736512175451519*^9, 3.736512176441378*^9}, {3.736512225601982*^9, 
   3.736512389461698*^9}, 3.73651242739983*^9, {3.736512503919557*^9, 
   3.7365125539844847`*^9}, {3.736513270158381*^9, 3.736513295301272*^9}, {
   3.736513343848724*^9, 3.736513344512207*^9}, {3.736513704829192*^9, 
   3.736513741481361*^9}, 3.736540232906405*^9, 3.736630602707755*^9, {
   3.736630844266911*^9, 3.736630844665359*^9}, {3.736631285072262*^9, 
   3.736631285503661*^9}, 3.736631340779907*^9, {3.7366314397667313`*^9, 
   3.736631474419909*^9}, {3.7366315601089897`*^9, 3.736631560672131*^9}, {
   3.736631618989326*^9, 3.736631619383033*^9}, {3.7366328353709383`*^9, 
   3.736632837846053*^9}, {3.736632884338785*^9, 3.7366328892037067`*^9}, 
   3.73663292665445*^9, {3.736633502560801*^9, 3.73663350474067*^9}, {
   3.73663356280809*^9, 3.736633563193592*^9}, {3.736633617791779*^9, 
   3.736633618125745*^9}, {3.736633685094461*^9, 3.736633692624807*^9}, {
   3.736633759955494*^9, 3.736633760252509*^9}, {3.7366338631069927`*^9, 
   3.736633863497044*^9}, 3.7366339267803993`*^9, {3.736634031858913*^9, 
   3.736634034453915*^9}, {3.736634221885963*^9, 3.736634223686491*^9}, {
   3.7366344619333982`*^9, 3.736634463096938*^9}, {3.736634581259543*^9, 
   3.736634582406487*^9}, {3.736634740719544*^9, 3.7366347576880913`*^9}, {
   3.7366347988131037`*^9, 3.7366347997208977`*^9}, {3.7366349690272017`*^9, 
   3.736635030178605*^9}, {3.736635246496913*^9, 3.736635258375383*^9}, {
   3.7366353028225613`*^9, 3.736635334660968*^9}, {3.736635376057127*^9, 
   3.7366353912368927`*^9}, {3.736635429181965*^9, 3.736635488980974*^9}, {
   3.7366355319077463`*^9, 3.736635532156436*^9}, {3.7366355732193317`*^9, 
   3.73663560253643*^9}, {3.736635659100154*^9, 3.736635687233654*^9}, {
   3.736635750205008*^9, 3.736635751597291*^9}, {3.736635791007415*^9, 
   3.7366357990828323`*^9}, {3.7366358480856943`*^9, 
   3.7366358504109297`*^9}, {3.736635895143162*^9, 3.73663592561415*^9}, {
   3.7366359862663393`*^9, 3.736636012630665*^9}, {3.73663605981308*^9, 
   3.736636060690772*^9}, {3.73663614333739*^9, 3.736636174245019*^9}, {
   3.7366362064836283`*^9, 3.736636207644121*^9}, {3.736636242478239*^9, 
   3.7366362574808903`*^9}, {3.736636335937117*^9, 3.7366363390139*^9}, {
   3.73663683950075*^9, 3.736636844574444*^9}, {3.736636946381456*^9, 
   3.736636974106007*^9}, {3.7366370162570744`*^9, 3.736637016540387*^9}, {
   3.7366370546827602`*^9, 3.73663705485323*^9}, {3.7366371008790007`*^9, 
   3.736637101622349*^9}, {3.736637154015921*^9, 3.736637154639575*^9}, {
   3.736637319329648*^9, 3.736637319758976*^9}, {3.736637382159309*^9, 
   3.736637388807209*^9}, {3.736637438829156*^9, 3.736637439768951*^9}, {
   3.736637479658593*^9, 3.736637480852747*^9}, {3.736637530408403*^9, 
   3.73663753339445*^9}, {3.736637566463594*^9, 3.7366375675194883`*^9}, {
   3.736637612737082*^9, 3.736637676898181*^9}, {3.736637712290038*^9, 
   3.736637731094922*^9}, {3.736637767157845*^9, 3.736637772106409*^9}, {
   3.736637899187161*^9, 3.736637928927576*^9}, {3.7366379816369467`*^9, 
   3.736638011089613*^9}, {3.736638070411202*^9, 3.7366381060843487`*^9}, 
   3.736638153986162*^9, {3.736638201841302*^9, 3.7366382202817993`*^9}, {
   3.736638298821013*^9, 3.736638299639448*^9}, {3.7366384356706133`*^9, 
   3.736638515527401*^9}, {3.736638554767981*^9, 3.736638562596757*^9}, {
   3.7366385994300117`*^9, 3.7366385996641397`*^9}, {3.7366386662189417`*^9, 
   3.736638696510002*^9}, {3.736638731122651*^9, 3.736638836227333*^9}, {
   3.736638919421427*^9, 3.7366389197918043`*^9}, {3.736638999860063*^9, 
   3.736639000259873*^9}, {3.736654328905549*^9, 3.736654340196517*^9}, {
   3.736654391744122*^9, 3.736654392337594*^9}, {3.736654446118568*^9, 
   3.73665447459194*^9}, {3.736654505489275*^9, 3.73665453012191*^9}, {
   3.736654609399658*^9, 3.7366546103487377`*^9}, {3.736654641903008*^9, 
   3.736654642281228*^9}, {3.73665468735317*^9, 3.736654698197793*^9}, {
   3.736654798858285*^9, 3.73665480070864*^9}, {3.73665496403797*^9, 
   3.736654964498081*^9}, {3.736655085754287*^9, 3.736655086180399*^9}, 
   3.736655154387154*^9, {3.736655250137827*^9, 3.736655250525445*^9}, {
   3.736655305780856*^9, 3.736655306832583*^9}, {3.7366553798294907`*^9, 
   3.736655380357407*^9}, {3.736655449007844*^9, 3.736655452791194*^9}, 
   3.7366555121073236`*^9, {3.736656812492341*^9, 3.7366568145736923`*^9}, {
   3.73665783001752*^9, 3.7366578338321238`*^9}, {3.7366695283596487`*^9, 
   3.736669529182653*^9}, 3.7366695816779633`*^9, {3.736669791065219*^9, 
   3.736669798191255*^9}, {3.7366699100422564`*^9, 3.736669911002776*^9}, {
   3.736671351670389*^9, 3.736671352510364*^9}, {3.7366714045111837`*^9, 
   3.736671405731353*^9}, {3.736672381839665*^9, 3.736672382849123*^9}, {
   3.736672448329335*^9, 3.7366724891985273`*^9}, {3.7366725967376213`*^9, 
   3.736672597268763*^9}, {3.736672631904564*^9, 3.7366726806147547`*^9}, {
   3.736672711316084*^9, 3.736672711610269*^9}, {3.736672824464176*^9, 
   3.736672828987217*^9}, {3.736672880535904*^9, 3.73667288259368*^9}, {
   3.7366729164401207`*^9, 3.73667291705847*^9}, {3.736672952909253*^9, 
   3.736672983883697*^9}, {3.736673015086884*^9, 3.736673045107469*^9}, {
   3.736673088912889*^9, 3.736673089084107*^9}, {3.736673265557123*^9, 
   3.7366732862722673`*^9}, {3.736673387423748*^9, 3.7366734420518017`*^9}, {
   3.736673500932383*^9, 3.7366735302878513`*^9}, {3.736673623013598*^9, 
   3.736673626481886*^9}, {3.736673787398213*^9, 3.736673821567782*^9}, {
   3.73667386269839*^9, 3.736673863049301*^9}, {3.736674533137268*^9, 
   3.7366745392297153`*^9}, {3.736674648262586*^9, 3.736674648818575*^9}, {
   3.736674679238514*^9, 3.7366746944811993`*^9}, {3.736674728875327*^9, 
   3.7366747396292057`*^9}, {3.736674774279729*^9, 3.736674774691114*^9}, {
   3.736674806139159*^9, 3.736674814847823*^9}, 3.736674849470717*^9, {
   3.73667488196459*^9, 3.736674907648223*^9}, {3.7366749377510242`*^9, 
   3.736674988155308*^9}, {3.7366750187286777`*^9, 3.7366750234714317`*^9}, {
   3.736675201074607*^9, 3.736675229053685*^9}, {3.736675277686756*^9, 
   3.736675279238336*^9}, {3.736675316123994*^9, 3.736675354149847*^9}, {
   3.736675440268312*^9, 3.736675441392188*^9}, {3.736675584397884*^9, 
   3.7366755846791153`*^9}, {3.736675655303735*^9, 3.736675677979301*^9}, {
   3.736675709504675*^9, 3.736675731855054*^9}, {3.736675761898122*^9, 
   3.736675790333729*^9}, {3.7366759658686438`*^9, 3.736675966481106*^9}, {
   3.736676009086561*^9, 3.736676009537373*^9}, {3.736676049086594*^9, 
   3.736676050930757*^9}, {3.736676083484483*^9, 3.736676084333791*^9}, {
   3.736676124654057*^9, 3.7366761258850603`*^9}, {3.736676168013467*^9, 
   3.7366761767346773`*^9}, {3.7366762333145113`*^9, 3.736676240132765*^9}, {
   3.736676296449068*^9, 3.736676304706985*^9}, 3.736676405612055*^9, {
   3.736676443028927*^9, 3.736676447623251*^9}, {3.736676508132889*^9, 
   3.7366765095586777`*^9}, {3.736676585361978*^9, 3.736676586322874*^9}, {
   3.736676757206533*^9, 3.736676802089954*^9}, {3.736676989559552*^9, 
   3.736676990014091*^9}, {3.736677075097736*^9, 3.736677136957011*^9}, {
   3.736677170857114*^9, 3.736677171588744*^9}, {3.736677211857214*^9, 
   3.736677216732078*^9}, {3.736677263081489*^9, 3.73667726806091*^9}, {
   3.736677303133046*^9, 3.736677310651116*^9}, {3.736677345976511*^9, 
   3.736677346398622*^9}, {3.736677380383128*^9, 3.736677436445921*^9}, {
   3.73667746894191*^9, 3.7366775934077997`*^9}, {3.736677636215556*^9, 
   3.736677636911038*^9}, {3.7366776858757877`*^9, 3.736677686334464*^9}, {
   3.73667772916297*^9, 3.736677764771923*^9}, {3.736677801488888*^9, 
   3.736677802414858*^9}, {3.736677874501318*^9, 3.736677970143992*^9}, {
   3.736678017808864*^9, 3.736678018266735*^9}, {3.736678054521422*^9, 
   3.736678055600502*^9}, {3.736678095143021*^9, 3.736678099283897*^9}, {
   3.736678145164605*^9, 3.736678178346881*^9}, {3.736678231745245*^9, 
   3.7366783001416883`*^9}, 3.736678333930752*^9, {3.736678373814039*^9, 
   3.736678409809984*^9}, {3.736678475675555*^9, 3.736678475891079*^9}, {
   3.736678510828302*^9, 3.7366785143595257`*^9}, {3.736678564772423*^9, 
   3.736678626059474*^9}, {3.736678682770555*^9, 3.736678683662644*^9}, {
   3.736678714869923*^9, 3.736678716403248*^9}, {3.736678874916748*^9, 
   3.736678875289586*^9}, {3.736678925603202*^9, 3.7366789365201483`*^9}, {
   3.736678994075013*^9, 3.7366790235262613`*^9}, {3.736679078981552*^9, 
   3.736679153830182*^9}, {3.736679184683379*^9, 3.736679233933867*^9}, {
   3.7366792755512037`*^9, 3.736679280182447*^9}, {3.736679327287122*^9, 
   3.736679328555241*^9}, {3.736679358788952*^9, 3.7366793617381983`*^9}, {
   3.736679400814499*^9, 3.73667942246576*^9}, {3.7366794605270443`*^9, 
   3.73667952826371*^9}, 3.7366795801871433`*^9, 3.736679696588262*^9, {
   3.736679726973731*^9, 3.7366797507249947`*^9}, {3.7366797826559343`*^9, 
   3.736679783884853*^9}, 3.736679849555869*^9, {3.736679880447568*^9, 
   3.73667988164647*^9}, {3.736679924166626*^9, 3.7366799670606813`*^9}, {
   3.736680113097241*^9, 3.7366801139813643`*^9}, {3.736680150816362*^9, 
   3.736680179438435*^9}, {3.736680383377213*^9, 3.7366804285037203`*^9}, {
   3.736680458875887*^9, 3.7366804598653507`*^9}, {3.736680491912465*^9, 
   3.7366805272714033`*^9}, {3.736680569908873*^9, 3.736680574434803*^9}, {
   3.7366806284815483`*^9, 3.736680653476717*^9}, 3.736680692778132*^9, {
   3.736680730419681*^9, 3.736680731652409*^9}, {3.73668080359324*^9, 
   3.7366808039911823`*^9}, {3.736680835593568*^9, 3.7366809342101393`*^9}, {
   3.7366809665773153`*^9, 3.736681014652234*^9}, {3.736681058509063*^9, 
   3.736681097723486*^9}, {3.7366811319138603`*^9, 3.736681158327099*^9}, {
   3.736681191636258*^9, 3.736681201319137*^9}, {3.736681251840645*^9, 
   3.736681252359517*^9}, {3.736681313426426*^9, 3.73668140179284*^9}, {
   3.736681438765787*^9, 3.7366814389898577`*^9}, 3.736681471215927*^9, {
   3.736681525541542*^9, 3.7366815258796577`*^9}, 3.736681559233205*^9, {
   3.736681656767457*^9, 3.736681657258555*^9}, {3.736681696697233*^9, 
   3.736681697112591*^9}, {3.736681734968668*^9, 3.736681757639645*^9}, {
   3.736681789427919*^9, 3.736681790296816*^9}, {3.7366818463351393`*^9, 
   3.736681846630026*^9}, 3.73668188975312*^9, 3.736681958093199*^9, {
   3.736682041461837*^9, 3.736682061556562*^9}, {3.7366820940980988`*^9, 
   3.736682106629867*^9}, {3.736682341120194*^9, 3.73668237024732*^9}, {
   3.736682490021248*^9, 3.736682490556458*^9}, {3.7366825215052557`*^9, 
   3.736682522280877*^9}, 3.7366825786177893`*^9, {3.7366829032099237`*^9, 
   3.736682904460512*^9}, {3.736682951095155*^9, 3.736682951668878*^9}, {
   3.736683002084244*^9, 3.7366830270885267`*^9}, {3.7366830939735603`*^9, 
   3.7366830998446407`*^9}, {3.7366831299965687`*^9, 3.736683140279285*^9}, {
   3.736683216113843*^9, 3.736683223165555*^9}, {3.7366832797342854`*^9, 
   3.736683333360672*^9}, {3.736683385307865*^9, 3.736683416662678*^9}, {
   3.736683455137424*^9, 3.7366834781373453`*^9}, {3.736683509804206*^9, 
   3.73668351147262*^9}, {3.7366836151368723`*^9, 3.736683615947493*^9}, {
   3.736741184844*^9, 3.7367411966934843`*^9}, {3.736741231075466*^9, 
   3.736741231207102*^9}, {3.736741284863164*^9, 3.736741285826149*^9}, {
   3.736741325067082*^9, 3.736741336567926*^9}, {3.736742386097156*^9, 
   3.7367424264078608`*^9}, {3.736742462970299*^9, 3.736742463494426*^9}, {
   3.736742604342828*^9, 3.736742604719842*^9}, {3.736743098160986*^9, 
   3.736743098540886*^9}, 3.736743149325494*^9, {3.736743629759973*^9, 
   3.7367436496153603`*^9}, {3.736743692297243*^9, 3.736743692598926*^9}, {
   3.7367438686511*^9, 3.736743869576723*^9}, {3.736744502684816*^9, 
   3.736744503850141*^9}, {3.73674460923449*^9, 3.73674461065137*^9}, {
   3.736744757090247*^9, 3.736744757422613*^9}, {3.736744791659172*^9, 
   3.736744791796618*^9}, {3.736745095723184*^9, 3.7367450963768063`*^9}, {
   3.736745773574087*^9, 3.7367457795499268`*^9}, {3.736746253163514*^9, 
   3.73674625393841*^9}, {3.736746328337536*^9, 3.73674634012773*^9}, {
   3.7367467004758377`*^9, 3.7367467010428457`*^9}, {3.73674673528362*^9, 
   3.736746741074317*^9}, {3.736747281804253*^9, 3.73674728324517*^9}, {
   3.7367474520577497`*^9, 3.736747490381688*^9}, {3.736747520462268*^9, 
   3.73674752437969*^9}, {3.7367477809155073`*^9, 3.736747844033298*^9}, {
   3.73674820702071*^9, 3.736748225782817*^9}, {3.736748259577043*^9, 
   3.736748260191814*^9}, {3.73674829104978*^9, 3.736748291528261*^9}, {
   3.7367483271101017`*^9, 3.73674839698952*^9}, {3.7367484631621017`*^9, 
   3.736748463562698*^9}, {3.73674850778161*^9, 3.736748508246542*^9}, {
   3.736748571756733*^9, 3.736748572344685*^9}, {3.736748612827941*^9, 
   3.736748615001362*^9}, {3.736748757291081*^9, 3.736748759241564*^9}, {
   3.736749078009262*^9, 3.736749078180183*^9}, {3.736749255220314*^9, 
   3.736749255371502*^9}, {3.73674937741193*^9, 3.736749379702773*^9}, {
   3.73674941231321*^9, 3.736749412584064*^9}, {3.736749827548943*^9, 
   3.736749884563649*^9}, {3.73675082152208*^9, 3.7367508396096573`*^9}, {
   3.736750871523217*^9, 3.736750872344727*^9}, {3.736750910090082*^9, 
   3.7367509773545094`*^9}, {3.736751075759486*^9, 3.736751120508388*^9}, {
   3.736751151526325*^9, 3.7367512340861607`*^9}, {3.736751264173974*^9, 
   3.7367513543093843`*^9}, {3.736751403469236*^9, 3.73675151653811*^9}, {
   3.736751557789899*^9, 3.736751660391261*^9}, {3.7367518067697277`*^9, 
   3.736752045291206*^9}, {3.736752077946763*^9, 3.736752221166733*^9}, {
   3.736752252492922*^9, 3.736752265875352*^9}, {3.736752296110023*^9, 
   3.736752379740334*^9}, {3.7367524409799337`*^9, 3.7367524876085157`*^9}, {
   3.736752525652508*^9, 3.7367525519439983`*^9}, {3.736752600311496*^9, 
   3.73675260055723*^9}, {3.736752804894081*^9, 3.7367529101071167`*^9}, {
   3.7367529453321543`*^9, 3.736752969072072*^9}, {3.736753036676629*^9, 
   3.736753065137103*^9}, {3.736753100574498*^9, 3.736753123046015*^9}, {
   3.736753446845681*^9, 3.736753478767136*^9}, {3.7367535709688187`*^9, 
   3.736753587096035*^9}, {3.736753790744567*^9, 3.736753797149728*^9}, {
   3.736753865327963*^9, 3.73675386657207*^9}, {3.736753907554515*^9, 
   3.736754000822798*^9}, {3.736754033231512*^9, 3.7367540344360867`*^9}, {
   3.736754122012082*^9, 3.736754127451105*^9}, {3.736754210802696*^9, 
   3.736754214106681*^9}, {3.736754258048769*^9, 3.7367542964504137`*^9}, {
   3.736754380103973*^9, 3.736754410729233*^9}, {3.736754440753875*^9, 
   3.736754442279903*^9}, {3.736754488942545*^9, 3.73675465600066*^9}, {
   3.7367546972323236`*^9, 3.736754938985264*^9}, {3.73675497453234*^9, 
   3.7367549746930523`*^9}, {3.736755018326599*^9, 3.736755018544559*^9}, {
   3.736755057689599*^9, 3.736755057857686*^9}, {3.7367550901033783`*^9, 
   3.736755116968129*^9}, {3.7367551675373898`*^9, 3.736755211480042*^9}, {
   3.736755319110898*^9, 3.736755362832065*^9}, {3.736755401769418*^9, 
   3.736755406572342*^9}, {3.736755443033517*^9, 3.7367554759202547`*^9}, {
   3.7367555468905497`*^9, 3.736755577796817*^9}, {3.736755945070417*^9, 
   3.736755945406151*^9}, {3.736756047463091*^9, 3.7367560953023033`*^9}, {
   3.736756137286572*^9, 3.736756221520939*^9}, {3.736756260087596*^9, 
   3.7367562672752934`*^9}, {3.7367562990386667`*^9, 3.736756319746244*^9}, {
   3.736756401660223*^9, 3.736756416105139*^9}, {3.736756476303131*^9, 
   3.73675655179427*^9}, {3.7367565920482903`*^9, 3.736756593225986*^9}, {
   3.7367567764093447`*^9, 3.736756787835717*^9}, {3.7367568387828617`*^9, 
   3.736756839320458*^9}, {3.736756909428362*^9, 3.7367569096240673`*^9}, {
   3.736756984991948*^9, 3.7367569858329153`*^9}, {3.736757121927224*^9, 
   3.736757122255756*^9}, {3.736757183143668*^9, 3.736757186492701*^9}, {
   3.7367572326451693`*^9, 3.73675723333733*^9}, {3.736757284830467*^9, 
   3.736757285393284*^9}, 3.736757334651968*^9, {3.736757429696005*^9, 
   3.736757436356238*^9}, {3.7367574828487053`*^9, 3.736757483104926*^9}, {
   3.7367575312680473`*^9, 3.7367575321180162`*^9}, {3.73675758175373*^9, 
   3.7367575821906433`*^9}, {3.7367577126387053`*^9, 
   3.7367577129634247`*^9}, {3.736757778589888*^9, 3.73675777976547*^9}, {
   3.7367578433334618`*^9, 3.736757883406535*^9}, 3.736758007653194*^9, {
   3.736758054853232*^9, 3.73675808126254*^9}, 3.736758118995926*^9, 
   3.736758155447493*^9, {3.736758185938033*^9, 3.736758192912012*^9}, {
   3.736758239188532*^9, 3.736758263048464*^9}, 3.7367583250819387`*^9, {
   3.7367615142634706`*^9, 3.7367615147710657`*^9}, {3.7368470344349117`*^9, 
   3.736847086847105*^9}, 3.736847123100134*^9, {3.736847155974841*^9, 
   3.736847170204034*^9}, {3.736847283419138*^9, 3.736847284043692*^9}, {
   3.736847348681436*^9, 3.7368473490054903`*^9}, {3.736847395729972*^9, 
   3.736847396087597*^9}, {3.7368474407050257`*^9, 3.736847441420828*^9}, {
   3.736847570271644*^9, 3.736847583255547*^9}, 3.736847788968132*^9, {
   3.736847941074313*^9, 3.736847943348525*^9}, {3.736847994955653*^9, 
   3.7368479981279507`*^9}, {3.7368480628619823`*^9, 3.736848063342854*^9}, {
   3.736848119682312*^9, 3.736848120210227*^9}, {3.736851670905205*^9, 
   3.736851671378175*^9}, {3.736851743332862*^9, 3.7368517464269533`*^9}, 
   3.736851853496807*^9, {3.7368521318522043`*^9, 3.73685213270473*^9}, {
   3.736852200368023*^9, 3.7368522015323553`*^9}, {3.7368522362920732`*^9, 
   3.736852236691555*^9}, {3.7368523229837837`*^9, 3.736852341310048*^9}, {
   3.736852375954871*^9, 3.7368523764164267`*^9}, {3.736852453792137*^9, 
   3.736852455240397*^9}, {3.736852502101632*^9, 3.736852512323892*^9}, {
   3.736852556515527*^9, 3.736852579965349*^9}, {3.7368526104216423`*^9, 
   3.736852641587483*^9}, {3.736852701864088*^9, 3.7368527162245893`*^9}, {
   3.736852766926654*^9, 3.736852767273621*^9}, {3.736852800582199*^9, 
   3.736852800921145*^9}, {3.736853650345839*^9, 3.736853650760228*^9}, 
   3.736853832692298*^9, 3.736853903137581*^9, {3.736854049441359*^9, 
   3.736854059971507*^9}, {3.7368541118874187`*^9, 3.736854112715397*^9}, {
   3.736854158613338*^9, 3.736854158900919*^9}, {3.736854208354388*^9, 
   3.736854229955838*^9}, {3.736889400252931*^9, 3.736889405382516*^9}, {
   3.7368895185726347`*^9, 3.736889528852397*^9}, {3.736889624192462*^9, 
   3.736889625447192*^9}, {3.7368909261775217`*^9, 3.736890930667391*^9}, {
   3.736890975168744*^9, 3.736890975831108*^9}, {3.73689103244967*^9, 
   3.736891033021422*^9}, {3.736891400634357*^9, 3.736891414888159*^9}, {
   3.73689152887215*^9, 3.73689153381826*^9}, 3.736891694067504*^9, {
   3.7368918837359667`*^9, 3.736891884050623*^9}, {3.736892041322014*^9, 
   3.736892041972003*^9}, {3.736892285824847*^9, 3.736892286254031*^9}, {
   3.736892385301176*^9, 3.736892399968768*^9}, 3.736892521896015*^9, {
   3.736893213426564*^9, 3.7368932347433987`*^9}, {3.73689537532134*^9, 
   3.736895376048991*^9}, 3.736895619104911*^9, {3.736895679032352*^9, 
   3.736895680055162*^9}, {3.7368999957544737`*^9, 3.736899996804366*^9}, {
   3.736900138076161*^9, 3.736900140160276*^9}, {3.7369002032821302`*^9, 
   3.736900209490938*^9}, {3.736900259796433*^9, 3.7369002948277617`*^9}, {
   3.7369003365868483`*^9, 3.736900449110862*^9}, {3.7369004870759993`*^9, 
   3.7369005362329597`*^9}, {3.736900615944867*^9, 3.73690064832723*^9}, {
   3.736900926093645*^9, 3.7369009273196993`*^9}, {3.736901387704624*^9, 
   3.736901408785809*^9}, {3.736901632757328*^9, 3.736901634146163*^9}, {
   3.736901664574163*^9, 3.736901691844626*^9}, {3.736901884672309*^9, 
   3.736901938302437*^9}, {3.736901989774379*^9, 3.736901998953453*^9}, {
   3.7369021469880466`*^9, 3.736902148463093*^9}, {3.736902209203227*^9, 
   3.7369022130665894`*^9}, {3.7369022488484077`*^9, 3.73690224936631*^9}, {
   3.7369046259252367`*^9, 3.736904626245179*^9}, {3.736906019287094*^9, 
   3.736906019661727*^9}, {3.736906071105906*^9, 3.736906071239088*^9}, {
   3.7369061097644367`*^9, 3.7369061116172743`*^9}, 3.7369072203758307`*^9, {
   3.736907559713266*^9, 3.7369075928075438`*^9}, {3.736907626241671*^9, 
   3.7369076265777483`*^9}, {3.736908530693529*^9, 3.736908531242414*^9}, {
   3.73690862151676*^9, 3.736908638851734*^9}, {3.7369086791980352`*^9, 
   3.736908682446446*^9}, {3.736908746107546*^9, 3.736908746657359*^9}, {
   3.736908814775868*^9, 3.736908815413862*^9}, {3.736909103950035*^9, 
   3.736909104322702*^9}, {3.736910160069808*^9, 3.736910167309947*^9}, {
   3.736910736709712*^9, 3.736910737183782*^9}, {3.736911235340878*^9, 
   3.736911235797069*^9}, {3.736911332818698*^9, 3.7369113427729*^9}, 
   3.736911976113639*^9, {3.736912043243498*^9, 3.736912057738142*^9}, {
   3.7369121140217123`*^9, 3.736912115607951*^9}, {3.7369121828901033`*^9, 
   3.736912198721263*^9}, 3.736913091859275*^9, {3.736913141809547*^9, 
   3.736913169565134*^9}, {3.7369132360252523`*^9, 3.736913236518875*^9}, 
   3.736913445178115*^9, {3.736913477913185*^9, 3.736913478397594*^9}, {
   3.736913616009232*^9, 3.736913686784107*^9}, {3.736913720592051*^9, 
   3.736913764430914*^9}, {3.7369138854182377`*^9, 3.7369139372174253`*^9}, {
   3.736914600901765*^9, 3.736914614797472*^9}, {3.736914700255004*^9, 
   3.736914730752719*^9}, {3.736914762765189*^9, 3.736914778893819*^9}, {
   3.736915026322925*^9, 3.736915030901156*^9}, {3.736915235417029*^9, 
   3.736915236130389*^9}, {3.736915489803237*^9, 3.7369154930622*^9}, {
   3.736918703770462*^9, 3.736918781862001*^9}, {3.7369274981738663`*^9, 
   3.7369275135555363`*^9}, 3.736936227664481*^9, {3.736936649218787*^9, 
   3.736936743639193*^9}, {3.73693684859515*^9, 3.736936952344555*^9}, {
   3.736937008201913*^9, 3.736937138514594*^9}, {3.736937454321641*^9, 
   3.736937454712916*^9}, {3.736937571689093*^9, 3.736937773750463*^9}, {
   3.736937826954625*^9, 3.736938032347178*^9}, {3.736938145055821*^9, 
   3.7369381560606327`*^9}, 3.7369381923147383`*^9, {3.7369417951578817`*^9, 
   3.7369418614877167`*^9}, {3.736941925519663*^9, 3.736941986465033*^9}, 
   3.7369420334242697`*^9, 3.736942351377954*^9, 3.736945758907086*^9, 
   3.736945826936796*^9, {3.7369460121969976`*^9, 3.736946012523383*^9}, {
   3.737012339679206*^9, 3.737012458173307*^9}, {3.73701250023582*^9, 
   3.7370125675317917`*^9}, {3.737171776291683*^9, 3.737171776867998*^9}, {
   3.7371718303356857`*^9, 3.7371718316180763`*^9}, {3.737171926840137*^9, 
   3.737171927162788*^9}, {3.7371719769393597`*^9, 3.737172044116474*^9}, {
   3.737172490314094*^9, 3.7371724974310923`*^9}, {3.7371725471300573`*^9, 
   3.737172549502451*^9}, {3.7371726296489143`*^9, 3.73717263074235*^9}, {
   3.737172671079026*^9, 3.73717267141002*^9}, {3.737172831043755*^9, 
   3.73717283628328*^9}, {3.737173003795148*^9, 3.737173071881482*^9}, {
   3.737173996742195*^9, 3.737174081052552*^9}, {3.737174116765154*^9, 
   3.737174117029859*^9}, {3.737174163866617*^9, 3.7371741641041517`*^9}, {
   3.7372636016561947`*^9, 3.7372636023103743`*^9}, {3.750720585991619*^9, 
   3.750720586248032*^9}},ExpressionUUID->"e5f3c9e4-8378-4e7b-8be5-\
a065a563b630"]
}, Open  ]],

Cell[CellGroupData[{

Cell["TPO", "Section",
 CellChangeTimes->{{3.736758609508656*^9, 
  3.736758610381894*^9}},ExpressionUUID->"6ae676cd-b9de-4f8c-9c3a-\
702243f9bbfd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tprod", "=", "61.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]T", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kS", "=", 
   RowBox[{"2.", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]T", "=", "144.87"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kT", "=", "3180"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nT", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]P", "=", "8.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vm", "=", 
   RowBox[{"1.", 
    FractionBox[
     RowBox[{"4", "\[Pi]", " ", 
      SuperscriptBox["21", "3"]}], "24"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]m", ":=", 
   RowBox[{"8.09", " ", 
    FractionBox["\[Tau]PM", "13.09"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]e", ":=", 
   RowBox[{"5.0", 
    FractionBox["\[Tau]PM", "13.09"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bP", "=", "308"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bm", "=", "706"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"be", "=", "92.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]mmin", "=", "0.38874"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]mmax", "=", "2.6828"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]emin", "=", "0.41022"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]emax", "=", "0.69335"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nP", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]m", "[", "x_", "]"}], ":=", 
   RowBox[{"\[Eta]mmin", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Eta]mmax", "-", "\[Eta]mmin"}], ")"}], 
     FractionBox["x", 
      RowBox[{"bm", "+", "x"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]e", "[", "x_", "]"}], ":=", 
   RowBox[{"\[Eta]emin", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Eta]emax", "-", "\[Eta]emin"}], ")"}], 
     FractionBox["x", 
      RowBox[{"be", "+", "x"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parafit", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "0.10288157818520864`", ",", "106.43615196259387`", ",", 
      "0.5476934020077088`", ",", "18.9780348899218`", ",", 
      "4.928656610539642`", ",", "9.209142977188922`", ",", 
      "2.0579480627961378`*^6", ",", "30", ",", "1", ",", 
      "0.07103989546756488`"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "s00", ",", "n00", ",", "p00", ",", "b", ",", "per", ",", "amp1", ",", 
     "amp2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", 
     RowBox[{"parafit", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"para2", "[", "b", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"per", "=", 
     RowBox[{"b", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"amp1", "=", 
     RowBox[{"b", "[", 
      RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"amp2", "=", 
     RowBox[{"b", "[", 
      RowBox[{"[", "10", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s00", ",", "n00", ",", "p00"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
      RowBox[{"solSS1", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sol1", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"T", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{"Tprod", "-", 
           RowBox[{"\[Gamma]T", " ", 
            RowBox[{"T", "[", "t", "]"}]}], "-", 
           RowBox[{"\[Alpha]T", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Vm", " ", 
               RowBox[{"\[Kappa]P", "[", "p0", "]"}], " ", 
               SuperscriptBox["10", 
                RowBox[{"-", "3"}]], 
               RowBox[{"s", "[", "t", "]"}], " ", "\[Tau]e", 
               "\[IndentingNewLine]", 
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[Eta]m", "[", 
                    RowBox[{"T", "[", 
                    RowBox[{"t", "-", "\[Tau]e", "-", "\[Tau]m"}], "]"}], 
                    "]"}], "+", 
                    RowBox[{"\[Eta]m", "[", 
                    RowBox[{"T", "[", 
                    RowBox[{"t", "-", "\[Tau]e"}], "]"}], "]"}]}], "2"], 
                    "\[Tau]m"}], "]"}], 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[Eta]e", "[", 
                    RowBox[{"T", "[", 
                    RowBox[{"t", "-", "\[Tau]e"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Eta]e", "[", 
                    RowBox[{"T", "[", "t", "]"}], "]"}]}], "2"], "\[Tau]e"}], 
                   "]"}]}], "\[IndentingNewLine]", "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[Eta]m", "[", 
                    RowBox[{"T", "[", 
                    RowBox[{"t", "-", "0", "-", "\[Tau]m"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"\[Eta]m", "[", 
                    RowBox[{"T", "[", 
                    RowBox[{"t", "-", "0"}], "]"}], "]"}]}], "2"], 
                    "\[Tau]m"}], "]"}], 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[Eta]e", "[", 
                    RowBox[{"T", "[", 
                    RowBox[{"t", "-", "0"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Eta]e", "[", 
                    RowBox[{"T", "[", "t", "]"}], "]"}]}], "2"], "0"}], 
                   "]"}]}]}], ")"}]}], "\[IndentingNewLine]", "+", 
              RowBox[{"kS", " ", "\[Beta]P", " ", "10", 
               RowBox[{"p", "[", "t", "]"}]}]}], ")"}], 
            FractionBox[
             SuperscriptBox[
              RowBox[{"T", "[", "t", "]"}], "nT"], 
             RowBox[{
              SuperscriptBox["kT", "nT"], "+", 
              SuperscriptBox[
               RowBox[{"T", "[", "t", "]"}], "nT"]}]]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{"Eq1", "[", 
           RowBox[{
            RowBox[{"s", "[", "t", "]"}], ",", 
            RowBox[{"n", "[", "t", "]"}], ",", 
            RowBox[{"r", "[", "t", "]"}], ",", 
            RowBox[{"p", "[", "t", "]"}], ",", 
            RowBox[{"s", "[", 
             RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{"Eq2", "[", 
           RowBox[{
            RowBox[{"s", "[", "t", "]"}], ",", 
            RowBox[{"n", "[", "t", "]"}], ",", 
            RowBox[{"s", "[", 
             RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
            RowBox[{"n", "[", 
             RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{"Eq4", "[", 
           RowBox[{
            RowBox[{"s", "[", "t", "]"}], ",", 
            RowBox[{"p", "[", "t", "]"}], ",", 
            RowBox[{"s", "[", 
             RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
            RowBox[{"p", "[", 
             RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
            RowBox[{"s", "[", 
             RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
            RowBox[{"p", "[", 
             RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"t", "/;", 
            RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "s00"}], 
         " ", ",", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"t", "/;", 
            RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
          RowBox[{"n00", "  ", "amp1", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"amp2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t", "+", "8"}], ")"}], "/", "per"}]}], "+", 
                RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"t", "/;", 
            RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "3.5"}], 
         ",", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"t", "/;", 
            RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
          RowBox[{"p00", " ", "amp1", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"amp2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", 
                 RowBox[{"t", "/", "per"}]}], "+", 
                RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"t", "/;", 
            RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
          "100"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"T", ",", "s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tf"}], "}"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tMax0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s", "/.", 
         RowBox[{"sol1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "@", 
       RowBox[{"Domain", "[", "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"s", "[", "t", "]"}], ",", 
        RowBox[{"p", "[", "t", "]"}], ",", 
        RowBox[{"n", "[", "t", "]"}], ",", 
        RowBox[{"T", "[", "t", "]"}]}], "}"}], "/.", 
      RowBox[{"sol1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tMax0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "\"\<FittingResults-Platelets-TPO-\>\"", "<>", 
    RowBox[{"ToString", "[", "PatientID", "]"}], "<>", "\"\<.dat\>\""}], ",", 
   "J"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"T", "[", "t", "]"}], "/.", "sol1"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "t", "]"}], "/.", "sol1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "t", "]"}], "/.", "sol1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     RowBox[{"tf", "-", "100"}], ",", "tf"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.736759025035138*^9, 3.736759273571594*^9}, {
   3.736759555994033*^9, 3.736759557222208*^9}, {3.736759632222035*^9, 
   3.736759684063375*^9}, {3.736759725960765*^9, 3.736759852484281*^9}, {
   3.736759892512925*^9, 3.736759946375155*^9}, {3.736760029886921*^9, 
   3.736760073402362*^9}, {3.736760804240858*^9, 3.736760860528235*^9}, {
   3.736760893711084*^9, 3.736760950214299*^9}, {3.736761015862596*^9, 
   3.736761138713471*^9}, {3.736761273752397*^9, 3.736761278655815*^9}, {
   3.7367624038614407`*^9, 3.73676240840377*^9}, 3.736762630036037*^9, 
   3.736762892148012*^9, 3.7367632999017267`*^9, 3.736765679625955*^9, {
   3.736765856322783*^9, 3.736765860514221*^9}, {3.7367660801179237`*^9, 
   3.736766132890218*^9}, {3.736915504049693*^9, 3.7369156496162653`*^9}, {
   3.736915682813939*^9, 3.736915712457925*^9}, {3.736915823961185*^9, 
   3.7369158252902718`*^9}, {3.736916273626606*^9, 3.736916293499342*^9}, {
   3.736917118375189*^9, 3.736917128114464*^9}, {3.736917945285469*^9, 
   3.736917956532956*^9}, {3.7369179910385923`*^9, 3.736917994943009*^9}, {
   3.736918130720121*^9, 3.736918137107152*^9}, 3.736918174556137*^9, 
   3.736918281030851*^9, {3.736918393234*^9, 3.7369186122117367`*^9}, {
   3.7369186480558033`*^9, 3.736918680594532*^9}, {3.736918721635976*^9, 
   3.736918722093424*^9}, {3.73691880015781*^9, 3.7369189609515657`*^9}, {
   3.736919032997148*^9, 3.736919038982706*^9}, {3.736919791475398*^9, 
   3.7369197967883368`*^9}, {3.737015258031107*^9, 3.737015276409999*^9}, {
   3.737015903686432*^9, 3.7370159074606247`*^9}, {3.73702237381139*^9, 
   3.7370223795699778`*^9}, {3.737022449633264*^9, 3.7370224518127403`*^9}, {
   3.750719517010047*^9, 
   3.750719521683526*^9}},ExpressionUUID->"cdf60070-310b-48ad-829c-\
5a542e26fde6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["RBC dynamics", "Title",
 CellChangeTimes->{{3.749772454827117*^9, 
  3.749772457183959*^9}},ExpressionUUID->"1512ae40-f3f2-4231-ad39-\
1b93327399d5"],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.749772631802511*^9, 
  3.749772632977622*^9}},ExpressionUUID->"f31d1287-58c1-432f-a4ae-\
ecfd3bf1cb8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Functionsr", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Eq1r", "[", 
        RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_", ",", "st_"}], "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "s", "]"}], "+", 
             RowBox[{"\[Kappa]N", "[", "n", "]"}], "+", 
             RowBox[{"\[Kappa]P", "[", "p", "]"}], "+", 
             RowBox[{"\[Kappa]R1", "[", "r", "]"}]}], ")"}]}], "s"}], "+", 
         RowBox[{"2", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[Gamma]S"}], " ", "\[Tau]S"}], "]"}], " ", 
          RowBox[{"\[Beta]", "[", "st", "]"}], "st"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq2r", "[", 
        RowBox[{"s_", ",", "n_", ",", "st_", ",", "nt_"}], "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Gamma]N"}], " ", "n"}], "+", 
         RowBox[{
          RowBox[{"AN", "[", "nt", "]"}], 
          RowBox[{"\[Kappa]N", "[", "nt", "]"}], 
          SuperscriptBox["10", 
           RowBox[{"-", "2"}]], "st"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq3r", "[", 
        RowBox[{
        "s_", ",", "r_", ",", "st_", ",", "rt_", ",", "sts_", ",", "rts_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Gamma]R"}], " ", "r"}], "+", 
        RowBox[{"AR", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Kappa]R1", "[", "rt", "]"}], 
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], "st"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[Gamma]R"}], " ", "\[Tau]RS"}], "]"}], 
            RowBox[{"\[Kappa]R1", "[", "rts", "]"}], 
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], "sts"}]}], ")"}]}]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq4r", "[", 
        RowBox[{
        "s_", ",", "p_", ",", "st_", ",", "pt_", ",", "sts_", ",", "pts_"}], 
        "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Gamma]P"}], " ", "p"}], "+", 
         RowBox[{
          RowBox[{"AP", "[", "pt", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Kappa]P", "[", "pt", "]"}], 
             SuperscriptBox["10", 
              RowBox[{"-", "4"}]], "st"}], "-", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "\[Gamma]P"}], " ", "\[Tau]PS"}], "]"}], 
             RowBox[{"\[Kappa]P", "[", "pts", "]"}], 
             SuperscriptBox["10", 
              RowBox[{"-", "4"}]], "sts"}]}], ")"}]}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Kappa]R1", "[", "r_", "]"}], ":=", 
       FractionBox["\[Kappa]Rbar", 
        RowBox[{"1", "+", 
         RowBox[{"Kr", " ", 
          SuperscriptBox["r", "s3"]}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r0", "=", "3.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", "0.001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Rbar", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AR", "=", "563000"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kr", "=", "0.0382"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s3", "=", "6.96"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]RM", "=", "6"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]RS", "=", 
       RowBox[{"120", "-", "6"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]Rsum", ":=", 
       RowBox[{"\[Tau]RM", "+", "\[Tau]RS"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solDDEr", "[", 
    RowBox[{"s00_", ",", "n00_", ",", "r00_", ",", "p00_", ",", "tf_"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sol", ",", "s", ",", "n", ",", "p", ",", "r", ",", "Eq1s", ",", "Eq2s",
        ",", "Eq3s", ",", "Eq4s", ",", "sol1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq1r", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]S"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq2r", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"n", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}], ",", 
              RowBox[{"n", "[", 
               RowBox[{"t", "-", "\[Tau]NM"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq3r", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"r", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]RM"}], "]"}], ",", 
              RowBox[{"r", "[", 
               RowBox[{"t", "-", "\[Tau]RM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Rsum"}], "]"}], ",", 
              RowBox[{"r", "[", 
               RowBox[{"t", "-", "\[Tau]Rsum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"Eq4r", "[", 
             RowBox[{
              RowBox[{"s", "[", "t", "]"}], ",", 
              RowBox[{"p", "[", "t", "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]PM"}], "]"}], ",", 
              RowBox[{"s", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"t", "-", "\[Tau]Psum"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "s00"}], ",", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "n00"}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "r00"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"t", "/;", 
              RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", 
            "p00"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Re", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"n", "[", "t", "]"}], ",", 
                   RowBox[{"s", "[", "t", "]"}], ",", 
                   RowBox[{"p", "[", "t", "]"}]}], "}"}], "]"}], "]"}], "<", 
               "0"}], "||", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"p", "[", "t", "]"}], ",", 
                    RowBox[{"n", "[", "t", "]"}], ",", 
                    RowBox[{"s", "[", "t", "]"}]}], "}"}], "]"}], "]"}], 
                "]"}], ">", "0.0001"}]}], ",", 
             RowBox[{
              RowBox[{"tMax", "=", "t"}], ";", "\[IndentingNewLine]", 
              "\"\<StopIntegration\>\""}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"-", "300"}], ",", "tf"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solSSr", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sol1", ",", "Eq1s", ",", "Eq2s", ",", "Eq3s", ",", "Eq4s"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Eq1s", "[", 
        RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq1r", "[", 
        RowBox[{"s", ",", "n", ",", "r", ",", "p", ",", "s"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq2s", "[", 
        RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq2r", "[", 
        RowBox[{"s", ",", "n", ",", "s", ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq3s", "[", 
        RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq3r", "[", 
        RowBox[{"s", ",", "r", ",", "s", ",", "r", ",", "s", ",", "r"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eq4s", "[", 
        RowBox[{"s_", ",", "n_", ",", "r_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Eq4r", "[", 
        RowBox[{"s", ",", "p", ",", "s", ",", "p", ",", "s", ",", "p"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol1", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Eq1s", "[", 
             RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "]"}], "\[Equal]", 
            "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq2s", "[", 
             RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "]"}], "\[Equal]", 
            "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq3s", "[", 
             RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "]"}], "\[Equal]", 
            "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Eq4s", "[", 
             RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "]"}], "\[Equal]", 
            "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "n0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "s0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "r0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "p0"}], "}"}]}], "}"}], ",", 
         RowBox[{"MaxIterations", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol1", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.749772856658312*^9, 3.7497728649642363`*^9}, {
   3.7497728960595093`*^9, 3.749772938567273*^9}, {3.749773875279323*^9, 
   3.749773909479232*^9}, {3.749774039585338*^9, 3.749774101100914*^9}, {
   3.7497741517919083`*^9, 3.749774165261877*^9}, {3.7497856765944357`*^9, 
   3.749785696085617*^9}, 3.7503766737073174`*^9, {3.750376777344665*^9, 
   3.75037677907367*^9}, {3.750376877495756*^9, 3.750376902340611*^9}, {
   3.750376952875338*^9, 3.750376956334366*^9}, {3.750377341162013*^9, 
   3.750377341516361*^9}, {3.750379723251132*^9, 3.750379735080428*^9}, {
   3.7503799110657253`*^9, 3.750379933943057*^9}, {3.750379973862092*^9, 
   3.7503800729783287`*^9}, {3.750380243761622*^9, 3.750380266794107*^9}, {
   3.750384618309299*^9, 3.750384651732873*^9}, {3.750384770770467*^9, 
   3.750384773883424*^9}, {3.750384838080373*^9, 3.750384868458877*^9}, {
   3.750385188445722*^9, 3.750385202903038*^9}, 3.750385374709543*^9, {
   3.750385496679845*^9, 3.7503855431850023`*^9}, {3.7503892069066277`*^9, 
   3.75038923846636*^9}, {3.750389279566986*^9, 3.7503893063947687`*^9}, {
   3.750389445430305*^9, 3.75038944845544*^9}, {3.750391000077951*^9, 
   3.750391086558304*^9}, {3.7503911890868893`*^9, 3.750391192033391*^9}, {
   3.750391432366453*^9, 3.75039144443134*^9}, {3.750391948072064*^9, 
   3.750391979445756*^9}, {3.750392078677709*^9, 3.750392078829763*^9}, {
   3.750394076785784*^9, 3.750394144554633*^9}, {3.750394202792869*^9, 
   3.750394203374653*^9}, {3.750394626911146*^9, 3.750394718653676*^9}, {
   3.750394981087619*^9, 3.750394983719071*^9}, {3.750395329348756*^9, 
   3.7503954204893837`*^9}, {3.750421783010042*^9, 3.750421799801486*^9}, {
   3.750421852235951*^9, 3.750421852526758*^9}, 3.750421940967955*^9, 
   3.750422060000863*^9, {3.750452430654132*^9, 3.7504524536356173`*^9}, {
   3.750452517217587*^9, 3.7504525225792418`*^9}, 3.750452575427176*^9, {
   3.750568855806705*^9, 3.750568859224104*^9}, {3.750570848756343*^9, 
   3.7505708698949223`*^9}, {3.750571182076277*^9, 3.7505713047762213`*^9}, {
   3.750574890418878*^9, 
   3.750574890771974*^9}},ExpressionUUID->"eb236069-9dcb-4b96-bb9f-\
539895a3d06a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare Pattern 1b and Pattern 2", "Section",
 CellChangeTimes->{{3.749774819652883*^9, 3.749774821455927*^9}, {
  3.750389323300016*^9, 
  3.75038933692866*^9}},ExpressionUUID->"d394cd15-1ad2-4eb8-b028-\
4a9471c76223"],

Cell[CellGroupData[{

Cell["Samples", "Subsection",
 CellChangeTimes->{{3.750390668534877*^9, 
  3.750390669843115*^9}},ExpressionUUID->"599b2f7b-29af-4ebb-bfe3-\
87f803787eff"],

Cell[BoxData[{
 RowBox[{"Functions", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDefaultValue", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Functionsr", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str1", "=", "\"\<RBC-samples\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<13\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "4"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAll", "[", 
      RowBox[{"sol", ",", "sol1", ",", "sol2", ",", "sol3", ",", "sol4"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Kappa]Pbar", ",", "\[Tau]PM"}], "}"}], "=", 
      RowBox[{"ParaSample", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tMax", "=", "tf"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol1", "=", 
      RowBox[{"solDDE", "[", 
       RowBox[{"s0", ",", "n0", ",", "p0", ",", "tf"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"-", "100.0001"}], ",", "tMax", ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol2", "=", 
      RowBox[{"solDDEr", "[", 
       RowBox[{"s0", ",", "n0", ",", "r0", ",", "p0", ",", "tf"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"J2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"-", "100.0001"}], ",", "tMax", ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<-1.dat\>\""}], ",", 
       "J1"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<-2.dat\>\""}], ",", 
       "J2"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "t", "]"}], "/.", "sol1"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "t", "]"}], "/.", "sol2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tf"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.750389354401881*^9, 3.7503893888696527`*^9}, {
   3.750389424381958*^9, 3.750389454329028*^9}, {3.750389485589333*^9, 
   3.750389488902528*^9}, {3.7503895369523563`*^9, 3.7503900039838867`*^9}, {
   3.7503900474167957`*^9, 3.750390079704721*^9}, {3.750390117891005*^9, 
   3.750390252025856*^9}, {3.7503905066220903`*^9, 3.750390519148136*^9}, {
   3.750390588916944*^9, 3.750390624412882*^9}, 3.750390681287724*^9, {
   3.750390732669318*^9, 3.7503908058749113`*^9}, {3.750390851961048*^9, 
   3.750390854985787*^9}, {3.750570892052058*^9, 3.7505708971420727`*^9}, 
   3.750574894337241*^9, {3.750579048094121*^9, 3.750579052573778*^9}, {
   3.750579390229072*^9, 3.750579464014018*^9}, {3.750579700445552*^9, 
   3.750579708311953*^9}, {3.750579796094596*^9, 3.750579796664629*^9}, {
   3.7505798450853653`*^9, 3.750579848416177*^9}, {3.750719568043459*^9, 
   3.750719570684863*^9}},ExpressionUUID->"74bbd0b7-5339-4e03-9170-\
c0e0f0560acf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Randomly choice of parameters", "Subsection",
 CellChangeTimes->{{3.750390711551231*^9, 
  3.750390720696774*^9}},ExpressionUUID->"2df1bfb1-fc6b-4a9b-be2e-\
200e84cdf141"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Functions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDefaultValue", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Functionsr", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"MakeDirNo", "[", 
    RowBox[{"\"\<13\>\"", ",", "path0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"No0", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"para2", "[", "b0_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Abs", "[", "b0", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "b"}], ",", "b"}], "}"}], "]"}]]}], "}"}], "*", 
        "para0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]Pbar", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PS", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]PM", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]P", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]var4", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"APmax", "=", 
       RowBox[{"c", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str1", "=", "\"\<RBC-random\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "No0"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDefaultValue", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"para2", "[", "1.5", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s01", ",", "n01", ",", "p01"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "n", ",", "p"}], "}"}], "/.", 
       RowBox[{"solSS", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol1", "=", 
      RowBox[{"solDDE", "[", 
       RowBox[{"s01", ",", 
        RowBox[{"1.01", "n0"}], ",", "p0", ",", "tf"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"-", "100.0001"}], ",", "tMax", ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tMax1", "=", "tMax"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s02", ",", "n02", ",", "r02", ",", "p02"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "n", ",", "r", ",", "p"}], "}"}], "/.", 
       RowBox[{"solSSr", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol2", "=", 
      RowBox[{"solDDEr", "[", 
       RowBox[{"s02", ",", 
        RowBox[{"1.01", "n02"}], ",", "r02", ",", "p02", ",", "tf"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"J2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"s", "[", "t", "]"}], ",", 
           RowBox[{"n", "[", "t", "]"}], ",", 
           RowBox[{"r", "[", "t", "]"}], ",", 
           RowBox[{"p", "[", "t", "]"}]}], "}"}], "/.", 
         RowBox[{"sol2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"-", "100.0001"}], ",", "tMax", ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tMax2", "=", "tMax"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<-1.dat\>\""}], ",", 
       "J1"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-md-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<-2.dat\>\""}], ",", 
       "J2"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a0", "=", 
      RowBox[{"{", 
       RowBox[{
       "i", ",", "\[Kappa]Pbar", ",", "\[Eta]Pbar", ",", "\[Tau]PS", ",", 
        "\[Tau]PM", ",", "\[Gamma]P", ",", "\[Theta]var4", ",", "tMax", ",", 
        "APmax", ",", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{"p", "[", "tMax1", "]"}], "]"}], "/.", "sol1"}], ",", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{"p", "[", "tMax2", "]"}], "]"}], "/.", "sol2"}], ",", 
        "tMax1", ",", "tMax2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-final.dat\>\""}], ",", "i"}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "a0"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"path", "<>", "str1", "<>", "\"\<-parameters-all.dat\>\""}], ",", 
   "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.750389354401881*^9, 3.7503893888696527`*^9}, {
  3.750389424381958*^9, 3.750389454329028*^9}, {3.750389485589333*^9, 
  3.750389488902528*^9}, {3.7503895369523563`*^9, 3.7503900039838867`*^9}, {
  3.7503900474167957`*^9, 3.750390079704721*^9}, {3.750390117891005*^9, 
  3.750390252025856*^9}, {3.7503905066220903`*^9, 3.750390519148136*^9}, {
  3.750390588916944*^9, 3.750390624412882*^9}, {3.750390681287724*^9, 
  3.750390729619569*^9}, {3.750574897906238*^9, 3.750574908542111*^9}, {
  3.750575040038741*^9, 3.75057504857292*^9}, {3.75057507901433*^9, 
  3.750575092833737*^9}, {3.750579104567535*^9, 3.750579105342895*^9}, {
  3.750579229796908*^9, 3.750579350805028*^9}, {3.7505797669119043`*^9, 
  3.750579814967414*^9}, {3.7505875457854137`*^9, 3.750587546413041*^9}, {
  3.7507195799549923`*^9, 
  3.750719582332364*^9}},ExpressionUUID->"fae59863-f3f8-4abe-a668-\
4b744466fa76"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1122, 881},
WindowMargins->{{Automatic, 184}, {28, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 2064, 50, 180, "Input", "ExpressionUUID" -> \
"a98d8271-bc84-4652-b007-57f3b9cbaade"],
Cell[CellGroupData[{
Cell[2489, 67, 216, 4, 92, "Title", "ExpressionUUID" -> \
"e9e70b1b-eeb4-4b12-ba42-c077f850a370"],
Cell[2708, 73, 25827, 556, 1919, "Input", "ExpressionUUID" -> \
"c34cd3d0-5416-4640-962a-8245b60f67c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28572, 634, 174, 3, 92, "Title", "ExpressionUUID" -> \
"9377e247-2762-49d0-8d12-94f8a9fc713c"],
Cell[CellGroupData[{
Cell[28771, 641, 159, 3, 64, "Section", "ExpressionUUID" -> \
"5b8d6ddf-cd42-43fc-aa76-f855a14f16c9"],
Cell[28933, 646, 4293, 97, 348, "Input", "ExpressionUUID" -> \
"7326e7a1-8e03-44db-8c31-059f2cccc48e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33275, 749, 164, 3, 92, "Title", "ExpressionUUID" -> \
"5fc3b555-05f4-437c-afda-fecd919e68f4"],
Cell[CellGroupData[{
Cell[33464, 756, 159, 3, 64, "Section", "ExpressionUUID" -> \
"3d75906a-5f7d-402c-b829-ff7261145129"],
Cell[33626, 761, 10062, 230, 774, "Input", "ExpressionUUID" -> \
"9c64574a-900f-4781-9bc3-0908ab03f847"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43725, 996, 214, 4, 64, "Section", "ExpressionUUID" -> \
"1a7b97d6-fcab-4b0e-974d-4b513065f427"],
Cell[43942, 1002, 8163, 212, 900, "Input", "ExpressionUUID" -> \
"69af023c-c7e8-4a7a-be14-bb7cf4331e0e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52154, 1220, 156, 3, 92, "Title", "ExpressionUUID" -> \
"b2774486-d7e5-4469-9fbe-3a482d17de06"],
Cell[CellGroupData[{
Cell[52335, 1227, 166, 3, 64, "Section", "ExpressionUUID" -> \
"cf8e96ba-4d5a-4aaa-a790-f4192fd5d2d4"],
Cell[52504, 1232, 19756, 486, 1230, "Input", "ExpressionUUID" -> \
"d10962af-3379-4912-ae30-083d0138d85f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72297, 1723, 300, 5, 64, "Section", "ExpressionUUID" -> \
"966d137b-1af7-4e9b-ac9a-2d10bb6b1c50"],
Cell[72600, 1730, 4871, 111, 411, "Input", "ExpressionUUID" -> \
"a39837ad-6556-4b85-a1f6-de46abfc76f5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77520, 1847, 156, 3, 92, "Title", "ExpressionUUID" -> \
"dc16079c-f52f-44e2-b1ee-678fa5df3794"],
Cell[CellGroupData[{
Cell[77701, 1854, 153, 3, 64, "Section", "ExpressionUUID" -> \
"5d0a77eb-7723-46dd-a798-6eba463ccbca"],
Cell[77857, 1859, 8743, 214, 600, "Input", "ExpressionUUID" -> \
"19f7de99-de5a-41e4-ad4f-fe65cb37f50d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86637, 2078, 167, 3, 64, "Section", "ExpressionUUID" -> \
"72111c56-4985-4161-9f22-f6372654bb46"],
Cell[86807, 2083, 6292, 143, 663, "Input", "ExpressionUUID" -> \
"25336165-3689-4d19-a765-a61d78e6232c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93136, 2231, 163, 3, 64, "Section", "ExpressionUUID" -> \
"81acb3ba-ad0e-43ad-b751-a275437bdd3d"],
Cell[93302, 2236, 13588, 320, 1410, "Input", "ExpressionUUID" -> \
"fa09d87f-779a-40f1-a148-cc543f40f818"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106939, 2562, 158, 3, 92, "Title", "ExpressionUUID" -> \
"d0367a3d-db38-49c6-b08f-9c2b9b7c7aeb"],
Cell[107100, 2567, 6160, 157, 579, "Input", "ExpressionUUID" -> \
"3f4f1e5d-43fc-4e10-912a-0376437a7f4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113297, 2729, 241, 4, 92, "Title", "ExpressionUUID" -> \
"887ec986-1490-4c31-9250-99f8c74597ab"],
Cell[CellGroupData[{
Cell[113563, 2737, 298, 5, 64, "Section", "ExpressionUUID" -> \
"0759ba09-f132-4bb7-8714-707ebc25bd0d"],
Cell[CellGroupData[{
Cell[113886, 2746, 32791, 705, 2322, "Input", "ExpressionUUID" -> \
"2dce5521-0180-4c4d-856b-62eaf680c86b"],
Cell[146680, 3453, 3797, 57, 21, "Message", "ExpressionUUID" -> \
"939aaed6-a9b3-4be7-bd7c-dac0751ffe46"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150526, 3516, 269, 5, 64, "Section", "ExpressionUUID" -> \
"961243a1-409d-4a15-b95f-41d2616d593b"],
Cell[150798, 3523, 27086, 590, 1923, "Input", "ExpressionUUID" -> \
"5bf09a50-4e26-4931-a24d-777b7a658e5e"],
Cell[CellGroupData[{
Cell[177909, 4117, 151, 3, 44, "Subsection", "ExpressionUUID" -> \
"cd4775fc-9b4d-4e67-aea0-3ade2ece67f3"],
Cell[178063, 4122, 18754, 407, 1209, "Input", "ExpressionUUID" -> \
"40fcb034-ace1-4788-aaec-fd105ed20ac5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196866, 4535, 165, 3, 64, "Section", "ExpressionUUID" -> \
"1ea9deee-0542-4f68-b6fc-8dd46f7a72b8"],
Cell[197034, 4540, 44726, 755, 1062, "Input", "ExpressionUUID" -> \
"e5f3c9e4-8378-4e7b-8be5-a065a563b630"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241797, 5300, 148, 3, 64, "Section", "ExpressionUUID" -> \
"6ae676cd-b9de-4f8c-9c3a-702243f9bbfd"],
Cell[241948, 5305, 14030, 351, 1247, "Input", "ExpressionUUID" -> \
"cdf60070-310b-48ad-829c-5a542e26fde6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[256027, 5662, 155, 3, 92, "Title", "ExpressionUUID" -> \
"1512ae40-f3f2-4231-ad39-1b93327399d5"],
Cell[CellGroupData[{
Cell[256207, 5669, 154, 3, 64, "Section", "ExpressionUUID" -> \
"f31d1287-58c1-432f-a4ae-ecfd3bf1cb8b"],
Cell[256364, 5674, 14181, 335, 914, "Input", "ExpressionUUID" -> \
"eb236069-9dcb-4b96-bb9f-539895a3d06a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270582, 6014, 225, 4, 64, "Section", "ExpressionUUID" -> \
"d394cd15-1ad2-4eb8-b028-4a9471c76223"],
Cell[CellGroupData[{
Cell[270832, 6022, 155, 3, 44, "Subsection", "ExpressionUUID" -> \
"599b2f7b-29af-4ebb-bfe3-87f803787eff"],
Cell[270990, 6027, 4629, 108, 411, "Input", "ExpressionUUID" -> \
"74bbd0b7-5339-4e03-9170-c0e0f0560acf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275656, 6140, 177, 3, 44, "Subsection", "ExpressionUUID" -> \
"2df1bfb1-fc6b-4a9b-be2e-200e84cdf141"],
Cell[275836, 6145, 8507, 208, 819, "Input", "ExpressionUUID" -> \
"fae59863-f3f8-4abe-a668-4b744466fa76"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

